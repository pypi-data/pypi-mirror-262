"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[402],{86054:function(e,n,t){var r=t(90849),i=t(90089),a=t(34896),s=t(38687),o=t(24246),c=["title","tooltip","children"];function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}n.Z=function(e){var n=e.title,t=e.tooltip,r=e.children,l=(0,i.Z)(e,c);return(0,o.jsxs)(a.xu,u(u({borderRadius:"md",border:"1px solid",borderColor:"gray.200"},l),{},{children:[(0,o.jsxs)(a.X6,{as:"h3",fontSize:"sm",fontWeight:"semibold",color:"gray.700",py:4,px:6,backgroundColor:"gray.50",borderRadius:"md",textAlign:"left",children:[n,t?(0,o.jsx)(a.xv,{as:"span",mx:1,children:(0,o.jsx)(s.Z,{label:t})}):void 0]}),(0,o.jsx)(a.Kq,{p:6,spacing:6,children:r})]}))}},56069:function(e,n,t){t.d(n,{R:function(){return h}});var r=t(90849),i=t(90089),a=t(34896),s=t(29549),o=t(73452),c=t(79894),l=t.n(c),u=t(24246),d=["backPath"],f=["onClick"];function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function g(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var h=function(e){var n=e.onClick,t=(0,i.Z)(e,f);return(0,u.jsxs)(a.kC,g(g({alignItems:"center",mt:-4,mb:3,onClick:n,cursor:"pointer"},t),{},{children:[(0,u.jsx)(s.hU,{"aria-label":"Back",icon:(0,u.jsx)(o.Rp,{}),mr:2,size:"xs",variant:"outline"}),(0,u.jsx)(a.xv,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})]}))};n.Z=function(e){var n=e.backPath,t=(0,i.Z)(e,d);return(0,u.jsxs)(a.kC,g(g({alignItems:"center",mb:6},t),{},{children:[(0,u.jsx)(l(),{href:n,passHref:!0,children:(0,u.jsx)(s.hU,{"aria-label":"Back",icon:(0,u.jsx)(o.Rp,{}),mr:2,size:"xs",variant:"outline"})}),(0,u.jsx)(l(),{href:n,passHref:!0,children:(0,u.jsx)(a.xv,{as:"a",fontSize:"sm",fontWeight:"500",children:"Back"})})]}))}},24753:function(e,n,t){t.d(n,{MA:function(){return u},Vo:function(){return f},t5:function(){return d}});var r=t(90849),i=t(34896),a=t(24246);function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var c=function(e){var n=e.children;return(0,a.jsxs)(i.xv,{"data-testid":"toast-success-msg",children:[(0,a.jsx)("strong",{children:"Success:"})," ",n]})},l=function(e){var n=e.children;return(0,a.jsxs)(i.xv,{"data-testid":"toast-error-msg",children:[(0,a.jsx)("strong",{children:"Error:"})," ",n]})},u={variant:"subtle",position:"top",description:"",duration:5e3,status:"success",isClosable:!0},d=function(e){var n=(0,a.jsx)(c,{children:e});return o(o({},u),{description:n})},f=function(e){var n=(0,a.jsx)(l,{children:e});return o(o({},u),{description:n,status:"error"})}},59190:function(e,n,t){t.d(n,{Z:function(){return G}});var r=t(55732),i=t(97865),a=t(90849),s=t(34707),o=t.n(s),c=t(34896),l=t(92975),u=t(70409),d=t(29549),f=t(58981),p=t(34090),g=t(86677),h=t(27378),j=t(6848),v=t(86054),b=t(43139),m=t(78624),x=t(60709),O=t(64429),y=t(38687),P=t(24753),w=t(75846),_=t(73679),k=t(20294),C=t(73452),D=t(49601),S=t(24246),Z=function(e){var n=e.index,t=e.name;return(0,S.jsxs)(c.kC,{direction:"column",gap:6,children:[(0,S.jsxs)(c.X6,{size:"sm",children:["Edit ",t," translation"]}),(0,S.jsx)(b.j0,{autoFocus:0!==n,name:"translations.".concat(n,".title"),label:"Title of consent notice as displayed to user",variant:"stacked"}),(0,S.jsx)(b.Ks,{name:"translations.".concat(n,".description"),label:"Privacy notice displayed to the user",variant:"stacked"})]})},z=function(e){var n=e.translation,t=e.name,r=e.onLanguageDeleted;return(0,S.jsxs)(c.kC,{gap:2,direction:"row",w:"100%",children:[(0,S.jsx)(k.OK,{as:d.zx,variant:"outline",size:"sm",fontWeight:"normal",w:"100%",_selected:{color:"white",bg:"gray.500"},children:t},n.language),r?(0,S.jsx)(d.hU,{"aria-label":"Delete translation",variant:"outline",size:"sm",onClick:function(){return r(n.language)},children:(0,S.jsx)(C.pJ,{boxSize:4})}):null]})},E=function(){var e=(0,p.u6)(),n=e.values,t=e.setFieldValue,r=(0,h.useState)(!1),i=r[0],a=r[1],s=(0,h.useState)(0),o=s[0],l=s[1],u=(0,j.C)(D.Zp),g=(0,j.C)(D.G1);(0,D.Ah)({page:u,size:g});var m=(0,j.C)(D.fJ).slice().sort((function(e,n){return e.name.localeCompare(n.name)})),x=m.filter((function(e){var t;return null===(t=n.translations)||void 0===t?void 0:t.every((function(n){return n.language!==e.id}))})).map((function(e){return{label:e.name,value:e.id}})),O=function(e){var r=n.translations?n.translations.slice().filter((function(n){return n.language!==e})):[],i=o===r.length?r.length-1:o;t("translations",r),l(i)},y=function(e){var n,t;return null!==(n=null===(t=m.find((function(n){return n.id===e})))||void 0===t?void 0:t.name)&&void 0!==n?n:e};return(0,S.jsx)(v.Z,{title:"Localizations",children:(0,S.jsxs)(k.mQ,{index:o,onChange:l,as:c.Ug,spacing:8,align:"start",grow:1,w:"100%",orientation:"vertical",variant:"unstyled",children:[(0,S.jsxs)(c.gC,{spacing:4,minW:"30%",p:2,children:[(0,S.jsx)(k.td,{w:"100%",children:(0,S.jsx)(c.gC,{spacing:2,w:"100%",p:4,maxH:60,overflow:"scroll",outline:"1px solid",outlineColor:"gray.200",borderRadius:"md",children:n.translations.map((function(e){return(0,S.jsx)(z,{translation:e,name:y(e.language),onLanguageDeleted:O},e.language)}))})}),i?(0,S.jsx)(c.xu,{w:"full","data-testid":"select-language",children:(0,S.jsx)(f.Z,{chakraStyles:b.hP,size:"sm",options:x,onChange:function(e){return function(e){var r={language:e,title:"",description:""};l(n.translations.length),t("translations",[].concat((0,_.Z)(n.translations),[r])),a(!1)}(e.value)},autoFocus:!0,classNamePrefix:"select-language",menuPlacement:"auto"})}):null,!i&&x.length?(0,S.jsx)(d.zx,{leftIcon:(0,S.jsx)(C.jB,{boxSize:6}),w:"full",variant:"outline",size:"sm",onClick:function(){return a(!0)},"data-testid":"add-language-btn",children:"Add a language"}):null]}),(0,S.jsx)(c.xu,{w:"100%",children:(0,S.jsx)(p.F2,{name:"translations",render:function(){return(0,S.jsx)(k.nP,{w:"100%",children:n.translations.map((function(e,n){return(0,S.jsx)(k.x4,{children:(0,S.jsx)(Z,{index:n,name:y(e.language)})},e.language)}))})}})})]})})},N=t(90089),R=t(68301),T=t(9865),I=["privacy_notice_history_id"];function q(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function F(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?q(Object(t),!0).forEach((function(n){(0,a.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):q(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var J=[{label:"Opt in",value:T.J7.OPT_IN},{label:"Opt out",value:T.J7.OPT_OUT},{label:"Notice only",value:T.J7.NOTICE_ONLY}],L=[{language:T.eU.EN,title:"",description:""}],V={name:"",consent_mechanism:T.J7.OPT_IN,data_uses:[],enforcement_level:T.QT.SYSTEM_WIDE,disabled:!0,translations:L},A=R.Ry().shape({name:R.Z_().required().label("Title"),consent_mechanism:R.Z_().required().label("Consent mechanism")}),K=t(14441),U=t.n(K),W=function(e){var n=e.isEditing,t=(0,p.u6)(),r=t.values,i=t.setFieldValue;return(0,h.useEffect)((function(){if(!n){var e=U()(r.name);i("notice_key",e)}}),[r.name,n,i]),(0,S.jsx)(b.j0,{name:"notice_key",label:"Key used in Fides cookie",variant:"stacked"})},B=t(15749);function M(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function H(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?M(Object(t),!0).forEach((function(n){(0,a.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):M(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var X=function(e){var n,t=e.regions,r=e.label,i=e.tooltip;return(0,S.jsxs)(c.gC,{align:"start",children:[(0,S.jsxs)(c.kC,{align:"start",children:[r?(0,S.jsx)(l.lX,{htmlFor:"regions",fontSize:"xs",my:0,mr:1,children:r}):null,i?(0,S.jsx)(y.Z,{label:i}):null]}),(0,S.jsx)(c.xu,{w:"100%","data-testid":"notice-locations",children:(0,S.jsx)(f.Z,{chakraStyles:H(H({},b.hP),{},{dropdownIndicator:function(e){return H(H({},e),{},{display:"none"})},multiValueRemove:function(e){return H(H({},e),{},{display:"none"})}}),classNamePrefix:"notice-locations",size:"sm",isMulti:!0,isDisabled:!0,placeholder:"No locations assigned",value:null!==(n=null===t||void 0===t?void 0:t.map((function(e){return{label:O.Z8[e],value:e}})))&&void 0!==n?n:[]})})]})},G=function(e){var n=e.privacyNotice,t=(0,g.useRouter)(),a=(0,u.pm)(),s=n?function(e){var n,t,r,i;return{name:null!==(n=e.name)&&void 0!==n?n:V.name,consent_mechanism:null!==(t=e.consent_mechanism)&&void 0!==t?t:V.consent_mechanism,data_uses:null!==(r=e.data_uses)&&void 0!==r?r:V.data_uses,enforcement_level:null!==(i=e.enforcement_level)&&void 0!==i?i:V.enforcement_level,notice_key:e.notice_key,disabled:e.disabled,has_gpc_flag:e.has_gpc_flag,id:e.id,internal_description:e.internal_description,translations:e.translations?e.translations.map((function(e){var n;return e.privacy_notice_history_id,F(F({},(0,N.Z)(e,I)),{},{title:null!==(n=e.title)&&void 0!==n?n:""})})):L}}(n):V;(0,w.fd)();var l=(0,j.C)(w.qv),f=(0,B.vL)(),O=(0,i.Z)(f,1)[0],y=(0,B.p4)(),_=(0,i.Z)(y,1)[0],k=(0,h.useMemo)((function(){return!!n}),[n]),C=function(){var e=(0,r.Z)(o().mark((function e(r){var i,s,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k){e.next=7;break}return c=H(H({},r),{},{id:n.id,enforcement_level:n.enforcement_level,translations:null!==(s=r.translations)&&void 0!==s?s:[]}),e.next=4,O(c);case 4:i=e.sent,e.next=10;break;case 7:return e.next=9,_(r);case 9:i=e.sent;case 10:(0,m.D4)(i)?a((0,P.Vo)((0,m.e$)(i.error))):(a((0,P.t5)("Privacy notice ".concat(k?"updated":"created"))),k||t.push(x.IT));case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,S.jsx)(p.J9,{initialValues:s,enableReinitialize:!0,onSubmit:C,validationSchema:A,children:function(e){var r=e.dirty,i=e.isValid,a=e.isSubmitting;return(0,S.jsx)(p.l0,{children:(0,S.jsxs)(c.Kq,{spacing:10,children:[(0,S.jsxs)(c.Kq,{spacing:6,children:[(0,S.jsxs)(v.Z,{title:"Privacy notice details",children:[(0,S.jsx)(b.j0,{label:"Notice title",name:"name",isRequired:!0,variant:"stacked"}),(0,S.jsx)(b.AP,{name:"consent_mechanism",label:"Consent mechanism",options:J,isRequired:!0,variant:"stacked"}),(0,S.jsx)(W,{isEditing:k}),(0,S.jsx)(X,{regions:null===n||void 0===n?void 0:n.configured_regions,label:"Locations where consent notice is shown to visitors",tooltip:"To configure locations, change the privacy experiences where this notice is shown"}),(0,S.jsx)(b.w8,{name:"has_gpc_flag",label:"Configure whether this notice conforms to the Global Privacy Control",variant:"stacked"}),(0,S.jsx)(b.AP,{name:"data_uses",label:"Data use",options:l,isMulti:!0,variant:"stacked"})]}),(0,S.jsx)(E,{})]}),(0,S.jsxs)(d.hE,{size:"sm",spacing:2,children:[(0,S.jsx)(d.zx,{variant:"outline",onClick:function(){t.back()},children:"Cancel"}),(0,S.jsx)(d.zx,{type:"submit",variant:"primary",size:"sm",isDisabled:a||!r||!i,isLoading:a,"data-testid":"save-btn",children:"Save"})]})]})})}})}}}]);