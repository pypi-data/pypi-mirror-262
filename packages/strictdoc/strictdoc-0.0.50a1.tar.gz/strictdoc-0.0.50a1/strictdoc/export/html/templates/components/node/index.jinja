{# needs sdoc_entity #}

{#
  This template can be included directly, and it will in turn include an entity.
  In this case you must use it with the variable:
      {%- with sdoc_entity = requirement -%}
      {% include "components/node/index.jinja" %}
      {%- endwith -%}

  This template can also be used as a base template.
  Then the {% block sdoc_entity %} block will overwrite the included entity
  in the extending template.
#}

{% set is_not_standalone = view_object.project_config.is_running_on_server and not view_object.standalone %}

<turbo-frame
{%- if is_not_standalone %}
  id="article-{{ sdoc_entity.reserved_mid }}"
{% endif -%}
>

  <sdoc-node
    {%- if is_not_standalone %}
      data-editable_node="on"
      {%- if sdoc_entity.is_section %}
      data-controller="anchor_controller"
      {%- endif %}
    {%- endif %}
    node-role="{{ sdoc_entity.get_type_string() }}"
    data-testid="node-{{ sdoc_entity.get_type_string() }}"
  >

    {# anchor #}
    {% include "components/anchor/index.jinja" %}

    {#
      copy_to_clipboard must be defined befor sdoc_entity block,
      and define them in node components that have editing options:
      node & root
    #}
    {%- set copy_to_clipboard = True -%}

    {# sdoc_entity #}
    {% block sdoc_entity %}
    {% include "components/"~sdoc_entity.get_type_string()~"/index.jinja" %}
    {% endblock sdoc_entity %}

    {# node_controls #}
    {%- if is_not_standalone -%}
    {% include "components/node/node_controls/index.jinja" %}
    {%- endif -%}

  </sdoc-node>
</turbo-frame>
