"use strict";(self.webpackChunk_secretflow_secretnote=self.webpackChunk_secretflow_secretnote||[]).push([[6],{16108:function(Qe,ne,e){e.d(ne,{h:function(){return D}});var Z=e(84041),W=e(10530),X=e(35667);function D(K){var N=K.items,_=K.onClick,E=K.icon,w=K.trigger;return N.length===0?null:(0,X.jsx)(Z.Z,{placement:"bottomLeft",menu:{items:N,onClick:function(G){var k=G.key,oe=G.domEvent;oe.stopPropagation(),_&&_(k)}},overlayClassName:"secretnote-dropdown-menu",trigger:w||["click"],children:(0,X.jsx)("span",{onClick:function(G){return G.stopPropagation()},children:E||(0,X.jsx)(W.Z,{size:14})})})}},31300:function(Qe,ne,e){e.d(ne,{p:function(){return y}});var Z=e(58601),W=e(84880),X=e(78796),D=e.n(X),K=e(4977),N=e.n(K),_=e(10154),E=e.n(_),w=e(47302),H=Symbol("MarkdownCellModelFactory"),G=e(26336),k=e.n(G),oe=e(41553),j=e.n(oe),I=e(49488),Q=e.n(I),le=e(84047),ce=e.n(le),Ae=e(62055),R=e.n(Ae),Y=e(23202),B=e(38168),ee=e(91798),ue=e(53353),L=e(58757),C=e(76711),Ye=e.n(C),P=e(90819),Je=e.n(P),me=e(89933),St=e.n(me),he=e(45332),de=e.n(he),ge=e(59972),Xe=e(95520),qe=e(73193),se=e.n(qe),p=e(64495),pe=e(77400),_e=e(51865),ye=e.n(_e),et=e(57975),tt=e(88680),nt=e(28125),ot=e(97860),be=e(80053),Ue=e(36756),$=e(10872),re=e(68625),s=e(35667),Te=[{name:"Default",color:"rgb(0 0 0)",label:p.U6.t("\u9ED8\u8BA4")},{name:"Purple",color:"#9333EA",label:p.U6.t("\u7D2B\u8272")},{name:"Red",color:"#E00000",label:p.U6.t("\u7EA2\u8272")},{name:"Yellow",color:"#EAB308",label:p.U6.t("\u9EC4\u8272")},{name:"Blue",color:"#2563EB",label:p.U6.t("\u84DD\u8272")},{name:"Green",color:"#008A00",label:p.U6.t("\u7EFF\u8272")},{name:"Orange",color:"#FFA500",label:p.U6.t("\u6A59\u8272")},{name:"Pink",color:"#BA4081",label:p.U6.t("\u7C89\u8272")},{name:"Gray",color:"#A8A29E",label:p.U6.t("\u7070\u8272")}],Le=[{name:"Default",color:"#ffffff",label:p.U6.t("\u9ED8\u8BA4")},{name:"Purple",color:"#f6f3f8",label:p.U6.t("\u7D2B\u8272")},{name:"Red",color:"#fdebeb",label:p.U6.t("\u7EA2\u8272")},{name:"Yellow",color:"#fbf4a2",label:p.U6.t("\u9EC4\u8272")},{name:"Blue",color:"#c1ecf9",label:p.U6.t("\u84DD\u8272")},{name:"Green",color:"#acf79f",label:p.U6.t("\u7EFF\u8272")},{name:"Orange",color:"#faebdd",label:p.U6.t("\u6A59\u8272")},{name:"Pink",color:"#faf1f5",label:p.U6.t("\u7C89\u8272")},{name:"Gray",color:"#f1f1ef",label:p.U6.t("\u7070\u8272")}],rt=function(r){var t=r.editor,o=r.isOpen,n=r.setIsOpen,a=Te.find(function(b){var v=b.color;return t.isActive("textStyle",{color:v})}),c=Le.find(function(b){var v=b.color;return t.isActive("highlight",{color:v})});return(0,s.jsx)(Ue.Z,{open:o,placement:"bottom",getPopupContainer:function(v){return v.parentNode},overlayStyle:{padding:0},content:(0,s.jsxs)("div",{className:"color-selector-popover-content",children:[(0,s.jsx)("div",{className:"color-selector-popover-content-title",children:"Color"}),Te.map(function(b,v){var S=b.name,F=b.color,A=b.label;return(0,s.jsxs)("button",{onClick:function(){t.commands.unsetColor(),S!=="Default"&&t.chain().focus().setColor(F||"").run(),n(!1)},className:"color-selector-button",type:"button",children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,s.jsx)("div",{className:"color-selector-space ",style:{color:F},children:"A"}),(0,s.jsx)("span",{children:A})]}),t.isActive("textStyle",{color:F})&&(0,s.jsx)($.Z,{className:"color-selector-check"})]},v)}),(0,s.jsx)("div",{className:"color-selector-Bg",children:"Background"}),Le.map(function(b,v){var S=b.name,F=b.color,A=b.label;return(0,s.jsxs)("button",{onClick:function(){t.commands.unsetHighlight(),S!=="Default"&&t.commands.setHighlight({color:F}),n(!1)},className:"color-selector-button",type:"button",children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,s.jsx)("div",{className:"color-selector-space",style:{backgroundColor:F},children:"A"}),(0,s.jsx)("span",{children:A})]}),t.isActive("highlight",{color:F})&&(0,s.jsx)($.Z,{className:"color-selector-children-icon"})]},v)})]}),children:(0,s.jsxs)("div",{className:"color-selector-children",onClick:function(v){v.stopPropagation(),n(!o)},children:[(0,s.jsx)("span",{className:"color-selector-children-text",style:{color:a==null?void 0:a.color,backgroundColor:c==null?void 0:c.color},children:"A"}),(0,s.jsx)(re.Z,{className:"color-selector-children-icon"})]})})},ve=e(80808);function fe(l){try{return new URL(l),!0}catch(r){return!1}}function V(l){if(fe(l))return l;try{if(l.includes(".")&&!l.includes(" "))return new URL("https://".concat(l)).toString()}catch(r){return null}}var U=function(r){var t=r.editor,o=r.isOpen,n=r.setIsOpen,a=(0,L.useRef)(null);return(0,L.useEffect)(function(){var c;a.current&&((c=a.current)===null||c===void 0||c.focus())}),(0,s.jsxs)("div",{className:"link-selector-content",children:[(0,s.jsxs)("button",{type:"button",className:"link-selector-button",onClick:function(){n(!o)},children:[(0,s.jsx)("p",{className:"link-selector-text-base",children:"\u2197"}),(0,s.jsx)("p",{className:ye()("link-selector-underline",{"link-selector-blue":t.isActive("link")}),children:p.U6.t("\u94FE\u63A5")})]}),o&&(0,s.jsxs)("form",{onSubmit:function(b){b.preventDefault();var v=b.currentTarget[0],S=V(v.value);S&&t.chain().focus().setLink({href:S}).run(),n(!1)},className:"link-selector-form",children:[(0,s.jsx)("input",{ref:a,type:"text",placeholder:p.U6.t("\u7C98\u8D34\u94FE\u63A5"),className:"link-selector-input",defaultValue:t.getAttributes("link").href||""}),t.getAttributes("link").href?(0,s.jsx)("button",{type:"button",className:"buttonLink",onClick:function(){t.chain().focus().unsetLink().run(),n(!1)},children:(0,s.jsx)(ve.Z,{className:"trash"})}):(0,s.jsx)("button",{className:"check",children:(0,s.jsx)($.Z,{className:"trash"})})]})]})},Me=e(81896),Ee=e(84613),Oe=e(95577),Re=e(34322),Ze=e(79370),Ce=e(74352),Ie=e(684),z=function(r){var t,o=r.editor,n=r.isOpen,a=r.setIsOpen,c=[{name:"Text",label:p.U6.t("\u6B63\u6587"),icon:Me.Z,command:function(){return o.chain().focus().toggleNode("paragraph","paragraph").run()},isActive:function(){return o.isActive("paragraph")&&!o.isActive("bulletList")&&!o.isActive("orderedList")}},{name:"Heading 1",label:p.U6.t("\u6807\u9898 1"),icon:Ee.Z,command:function(){return o.chain().focus().toggleHeading({level:1}).run()},isActive:function(){return o.isActive("heading",{level:1})}},{name:"Heading 2",label:p.U6.t("\u6807\u9898 2"),icon:Oe.Z,command:function(){return o.chain().focus().toggleHeading({level:2}).run()},isActive:function(){return o.isActive("heading",{level:2})}},{name:"Heading 3",label:p.U6.t("\u6807\u9898 3"),icon:Re.Z,command:function(){return o.chain().focus().toggleHeading({level:3}).run()},isActive:function(){return o.isActive("heading",{level:3})}},{name:"To-do List",label:p.U6.t("\u4EFB\u52A1\u5217\u8868"),icon:Ze.Z,command:function(){return o.chain().focus().toggleTaskList().run()},isActive:function(){return o.isActive("taskItem")}},{name:"Bullet List",label:p.U6.t("\u65E0\u5E8F\u5217\u8868"),icon:Ce.Z,command:function(){return o.chain().focus().toggleBulletList().run()},isActive:function(){return o.isActive("bulletList")}},{name:"Numbered List",label:p.U6.t("\u6709\u5E8F\u5217\u8868"),icon:Ce.Z,command:function(){return o.chain().focus().toggleOrderedList().run()},isActive:function(){return o.isActive("orderedList")}},{name:"Quote",label:p.U6.t("\u5F15\u7528"),icon:Ie.Z,command:function(){return o.chain().focus().toggleNode("paragraph","paragraph").toggleBlockquote().run()},isActive:function(){return o.isActive("blockquote")}},{name:"Code",label:p.U6.t("\u4EE3\u7801\u5757"),icon:be.Z,command:function(){return o.chain().focus().toggleCodeBlock().run()},isActive:function(){return o.isActive("codeBlock")}}],b=(t=c.filter(function(v){return v.isActive()}).pop())!==null&&t!==void 0?t:{name:"Multiple",label:p.U6.t("\u591A\u4E2A")};return(0,s.jsx)(Ue.Z,{open:n,overlayStyle:{padding:0},getPopupContainer:function(S){return S.parentNode},placement:"bottom",content:(0,s.jsx)("div",{className:"node-selector-content",children:c.map(function(v,S){return(0,s.jsxs)("button",{onClick:function(){v.command(),a(!1)},className:"node-selector-button-Item",type:"button",children:[(0,s.jsxs)("div",{className:"node-selector-item",children:[(0,s.jsx)("div",{className:"node-selector-item-contentIcon",children:(0,s.jsx)(v.icon,{className:"node-selector-item-Icon"})}),(0,s.jsx)("span",{children:v.label})]}),b.name===v.name&&(0,s.jsx)($.Z,{className:"node-selector-textIcon"})]},S)})}),children:(0,s.jsxs)("div",{className:"node-selector-text",onClick:function(S){S.stopPropagation(),a(!n)},children:[(0,s.jsx)("span",{children:b==null?void 0:b.label}),(0,s.jsx)(re.Z,{className:"node-selector-textIcon"})]})})},it=function(r){var t=r.editor,o=[{name:"bold",label:p.U6.t("\u7C97\u4F53"),isActive:function(){return t.isActive("bold")},command:function(){return t.chain().focus().toggleBold().run()},icon:et.Z},{name:"italic",label:p.U6.t("\u659C\u4F53"),isActive:function(){return t.isActive("italic")},command:function(){return t.chain().focus().toggleItalic().run()},icon:tt.Z},{name:"underline",label:p.U6.t("\u4E0B\u5212\u7EBF"),isActive:function(){return t.isActive("underline")},command:function(){return t.chain().focus().toggleUnderline().run()},icon:nt.Z},{name:"strike",label:p.U6.t("\u5220\u9664\u7EBF"),isActive:function(){return t.isActive("strike")},command:function(){return t.chain().focus().toggleStrike().run()},icon:ot.Z},{name:"code",label:p.U6.t("\u884C\u5185\u4EE3\u7801"),isActive:function(){return t.isActive("code")},command:function(){return t.chain().focus().toggleCode().run()},icon:be.Z}],n=se()(se()({},r),{},{shouldShow:function(je){var q=je.state,Se=je.editor,ae=q.selection,Ke=ae.empty;return!(Se.isActive("image")||Ke||(0,pe.EG)(ae))},tippyOptions:{moveTransition:"transform 0.15s ease-out",onHidden:function(){v(!1),te(!1),Ne(!1)}}}),a=(0,L.useState)(!1),c=de()(a,2),b=c[0],v=c[1],S=(0,L.useState)(!1),F=de()(S,2),A=F[0],te=F[1],ie=(0,L.useState)(!1),Ve=de()(ie,2),We=Ve[0],Ne=Ve[1];return(0,s.jsxs)(ge.NM,se()(se()({},n),{},{className:"bubbleMenuContent",children:[(0,s.jsx)(z,{editor:t,isOpen:b,setIsOpen:function(){v(!b),te(!1),Ne(!1)}}),(0,s.jsx)(U,{editor:t,isOpen:We,setIsOpen:function(){Ne(!We),te(!1),v(!1)}}),(0,s.jsx)("div",{className:"bubbleMenuButtonContent",children:o.map(function(T,je){return(0,s.jsx)("button",{onClick:T.command,className:"bubbleMenuButton",type:"button",children:(0,s.jsx)(T.icon,{className:ye()("icon",{iconActive:T.isActive()})})},je)})}),(0,s.jsx)(rt,{editor:t,isOpen:A,setIsOpen:function(){te(!A),v(!1),Ne(!1)}})]}))},At=e(32979),at=e(79175),Ut=e(26720),lt=e(93638),Tt=e(1993),st=e(67188),ct=e(53461),O=e(7975),ze=e(83249),ut=e(11673),Lt=e(72166),dt=e(85504),Mt=e(26216),Et=e(92228),Ot=pe.hj.create({name:"slash-command",addOptions:function(){return{suggestion:{char:"/",command:function(t){var o=t.editor,n=t.range,a=t.props;a.command({editor:o,range:n})}}}},addProseMirrorPlugins:function(){return[(0,dt.ZP)(se()({editor:this.editor},this.options.suggestion))]}}),vt=function(r){var t=r.query;return[{title:"Text",description:"Just start typing with plain text.",searchTerms:["p","paragraph"],icon:(0,s.jsx)(Me.Z,{size:18}),command:function(n){var a=n.editor,c=n.range;a.chain().focus().deleteRange(c).toggleNode("paragraph","paragraph").run()}},{title:"To-do List",description:"Track tasks with a to-do list.",searchTerms:["todo","task","list","check","checkbox"],icon:(0,s.jsx)(Ze.Z,{size:18}),command:function(n){var a=n.editor,c=n.range;a.chain().focus().deleteRange(c).toggleTaskList().run()}},{title:"Heading 1",description:"Big section heading.",searchTerms:["title","big","large"],icon:(0,s.jsx)(Ee.Z,{size:18}),command:function(n){var a=n.editor,c=n.range;a.chain().focus().deleteRange(c).setNode("heading",{level:1}).run()}},{title:"Heading 2",description:"Medium section heading.",searchTerms:["subtitle","medium"],icon:(0,s.jsx)(Oe.Z,{size:18}),command:function(n){var a=n.editor,c=n.range;a.chain().focus().deleteRange(c).setNode("heading",{level:2}).run()}},{title:"Heading 3",description:"Small section heading.",searchTerms:["subtitle","small"],icon:(0,s.jsx)(Re.Z,{size:18}),command:function(n){var a=n.editor,c=n.range;a.chain().focus().deleteRange(c).setNode("heading",{level:3}).run()}},{title:"Bullet List",description:"Create a simple bullet list.",searchTerms:["unordered","point"],icon:(0,s.jsx)(Mt.Z,{size:18}),command:function(n){var a=n.editor,c=n.range;a.chain().focus().deleteRange(c).toggleBulletList().run()}},{title:"Numbered List",description:"Create a list with numbering.",searchTerms:["ordered"],icon:(0,s.jsx)(Ce.Z,{size:18}),command:function(n){var a=n.editor,c=n.range;a.chain().focus().deleteRange(c).toggleOrderedList().run()}},{title:"Quote",description:"Capture a quote.",searchTerms:["blockquote"],icon:(0,s.jsx)(Ie.Z,{size:18}),command:function(n){var a=n.editor,c=n.range;return a.chain().focus().deleteRange(c).toggleNode("paragraph","paragraph").toggleBlockquote().run()}},{title:"Code",description:"Capture a code snippet.",searchTerms:["codeblock"],icon:(0,s.jsx)(be.Z,{size:18}),command:function(n){var a=n.editor,c=n.range;return a.chain().focus().deleteRange(c).toggleCodeBlock().run()}}].filter(function(o){if(typeof t=="string"&&t.length>0){var n=t.toLowerCase();return o.title.toLowerCase().includes(n)||o.description.toLowerCase().includes(n)||o.searchTerms&&o.searchTerms.some(function(a){return a.includes(n)})}return!0})},ft=function(r,t){var o=r.offsetHeight,n=t?t.offsetHeight:0,a=t.offsetTop,c=a+n;a<r.scrollTop?r.scrollTop-=r.scrollTop-a+5:c>o+r.scrollTop&&(r.scrollTop+=c-o-r.scrollTop+5)},mt=function(r){var t=r.items,o=r.command,n=(0,L.useState)(0),a=de()(n,2),c=a[0],b=a[1],v=(0,L.useCallback)(function(F){var A=t[F];A&&o(A)},[o,t]);(0,L.useEffect)(function(){var F=["ArrowUp","ArrowDown","Enter"],A=function(ie){if(F.includes(ie.key))return ie.preventDefault(),ie.key==="ArrowUp"?(b((c+t.length-1)%t.length),!0):ie.key==="ArrowDown"?(b((c+1)%t.length),!0):ie.key==="Enter"?(v(c),!0):!1};return document.addEventListener("keydown",A),function(){document.removeEventListener("keydown",A)}},[t,c,b,v]),(0,L.useEffect)(function(){b(0)},[t]);var S=(0,L.useRef)(null);return(0,L.useLayoutEffect)(function(){var F=S==null?void 0:S.current,A=F==null?void 0:F.children[c];A&&F&&ft(F,A)},[c]),t.length>0?(0,s.jsx)("div",{id:"slash-command",ref:S,className:"slash-command",children:t.map(function(F,A){return(0,s.jsxs)("button",{className:ye()({selected:A===c}),onClick:function(){return v(A)},children:[(0,s.jsx)("div",{className:"icon",children:F.icon}),(0,s.jsxs)("div",{className:"content",children:[(0,s.jsx)("p",{className:"title",children:F.title}),(0,s.jsx)("p",{className:"description",children:F.description})]})]},A)})}):null},ht=function(){var r=null,t=null;return{onStart:function(n){r=new ge.M_(mt,{props:n,editor:n.editor}),t=(0,Et.ZP)("body",{getReferenceClientRect:n.clientRect,appendTo:function(){return document.body},content:r.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"})},onUpdate:function(n){var a;(a=r)===null||a===void 0||a.updateProps(n),t&&t[0].setProps({getReferenceClientRect:n.clientRect})},onKeyDown:function(n){var a;if(n.event.key==="Escape"){var c;return(c=t)===null||c===void 0||c[0].hide(),!0}return(a=r)===null||a===void 0||(a=a.ref)===null||a===void 0?void 0:a.onKeyDown(n)},onExit:function(){var n,a;(n=t)===null||n===void 0||n[0].destroy(),(a=r)===null||a===void 0||a.destroy()}}},gt=Ot.configure({suggestion:{items:vt,render:ht}}),J=gt,Rt=[ut.V.configure({bulletList:{HTMLAttributes:{class:"bullet-list"}},orderedList:{HTMLAttributes:{class:"order-list"}},listItem:{HTMLAttributes:{class:"list-item"}},blockquote:{HTMLAttributes:{class:"blockquote"}},codeBlock:{HTMLAttributes:{class:"code-block"}},code:{HTMLAttributes:{class:"code",spellcheck:"false"}},horizontalRule:!1,dropcursor:{color:"#DBEAFE",width:4},gapcursor:!1}),Ut.b.extend({addInputRules:function(){var r=this;return[new pe.VK({find:/^(?:---|â€”-|___\s|\*\*\*\s)$/,handler:function(o){var n=o.state,a=o.range,c={},b=n.tr,v=a.from,S=a.to;b.insert(v-1,r.type.create(c)).delete(b.mapping.map(v),b.mapping.map(S))}})]}}).configure({HTMLAttributes:{class:"horizontal"}}),lt.ZP.configure({HTMLAttributes:{class:"link-text"}}),Tt.V.configure({placeholder:function(r){var t=r.node;return t.type.name==="heading"?"Heading ".concat(t.attrs.level):"Press '/' for commands"},includeChildren:!0}),J,ze.Z,O.p,At.I,at.y$.configure({multicolor:!0}),ct.a.configure({HTMLAttributes:{class:"task-list"}}),st.Uf.configure({HTMLAttributes:{class:"task-list-item"},nested:!0}),Lt.U.configure({html:!0,transformCopiedText:!0})];function pt(l){var r=l.defaultValue,t=r===void 0?"":r,o=l.extensions,n=o===void 0?[]:o,a=l.onUpdate,c=a===void 0?function(){}:a,b=l.onDebouncedUpdate,v=b===void 0?function(){}:b,S=(0,L.useState)(t),F=de()(S,2),A=F[0],te=F[1],ie=(0,L.useState)(!1),Ve=de()(ie,2),We=Ve[0],Ne=Ve[1],T=(0,Xe.Z)(function(){var Se=St()(Je()().mark(function ae(Ke){var Ge,It;return Je()().wrap(function(zt){for(;;)switch(zt.prev=zt.next){case 0:Ge=Ke.editor,It=Ge.storage.markdown.getMarkdown(),te(It),v(Ge,It);case 4:case"end":return zt.stop()}},ae)}));return function(ae){return Se.apply(this,arguments)}}(),{wait:1e3}),je=T.run,q=(0,ge.jE)({extensions:[].concat(Ye()(Rt),Ye()(n)),editorProps:{handleDOMEvents:{keydown:function(ae,Ke){if(["ArrowUp","ArrowDown","Enter"].includes(Ke.key)){var Ge=document.querySelector("#slash-command");if(Ge)return!0}}}},onUpdate:function(ae){c(ae.editor),je(ae)},autofocus:"end"});return(0,L.useEffect)(function(){q&&A&&!We&&(q.commands.setContent(A),Ne(!0))},[q,A,We]),(0,s.jsxs)("div",{onClick:function(){q==null||q.chain().focus().run()},className:"markdown-editor",children:[q&&(0,s.jsx)(it,{editor:q}),(0,s.jsx)(ge.kg,{editor:q})]})}var yt,bt,Ct,kt,ke,xe,xt,Ft,Nt=(0,L.forwardRef)(function(l,r){var t=(0,B.oC)(ee.yd);return(0,s.jsx)("div",{ref:r,onFocus:function(){t.focus(!0)},onBlur:function(n){var a;typeof r!="function"&&!(r!=null&&(a=r.current)!==null&&a!==void 0&&a.contains(n.relatedTarget))&&t.blur()},className:"markdown-cell",children:(0,s.jsx)(pt,{defaultValue:t.cellModel.value,onDebouncedUpdate:function(n,a){t.cellModel.value=a||""}})})});Nt.displayName="MarkdownCell";var we=(yt=(0,w.H3)(),bt=(0,ue.ei)("markdown-cell-view"),Ct=(0,B.vg)(),kt=(0,B.vg)(),yt(ke=bt(ke=(xe=function(l){Q()(t,l);var r=ce()(t);function t(){var o;D()(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return o=r.call.apply(r,[this].concat(a)),E()(j()(o),"view",Nt),k()(j()(o),"headingCollapsed",xt,j()(o)),k()(j()(o),"collapsibleChildNumber",Ft,j()(o)),E()(j()(o),"getSelectionsOffsetAt",function(){return{start:0,end:0}}),E()(j()(o),"getSelections",function(){return[]}),o}return N()(t,[{key:"cellModel",get:function(){return this.model}},{key:"wrapperCls",get:function(){return"secretnote-markdown-cell"}},{key:"focus",value:function(n){n&&(this.cellModel.isEdit=!0)}},{key:"blur",value:function(){this.cellModel.isEdit=!1}},{key:"shouldEnterEditorMode",value:function(){return this.cellModel.isEdit}}]),t}(Z.Plf),xt=R()(xe.prototype,"headingCollapsed",[Ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ft=R()(xe.prototype,"collapsibleChildNumber",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),xe))||ke)||ke),Pe,De,He,Be,M,Zt=(Pe=(0,w.ri)({contrib:[Z.SqL,Z.GDy]}),De=function(r,t){return(0,w.f3)(H)(r,void 0,0)},He=Reflect.metadata("design:type",Function),Be=Reflect.metadata("design:paramtypes",[typeof H=="undefined"?Object:H]),Pe(M=De(M=He(M=Be(M=function(){function l(r){D()(this,l),E()(this,"modelFactory",void 0),E()(this,"cellMeta",{type:"markdown",name:"Markdown",order:"c"}),E()(this,"view",we),this.modelFactory=r}return N()(l,[{key:"canHandle",value:function(t){var o;return(t==null||(o=t.cell)===null||o===void 0?void 0:o.cell_type)===this.cellMeta.type?1e3:-1}},{key:"createModel",value:function(t){var o=this.modelFactory(t);return o}}]),l}())||M)||M)||M)||M),Fe,$e,jt,x,m,i,h,d,g,f,u=(Fe=(0,w.H3)(),$e=function(r,t){return(0,w.f3)(Z.seq)(r,void 0,0)},jt=Reflect.metadata("design:type",Function),x=Reflect.metadata("design:paramtypes",[typeof Z.seq=="undefined"?Object:Z.seq]),m=(0,B.vg)(),i=(0,B.vg)(),Fe(h=$e(h=jt(h=x(h=(d=function(l){Q()(t,l);var r=ce()(t);function t(o){var n;return D()(this,t),n=r.call(this,o),k()(j()(n),"mimeType",g,j()(n)),k()(j()(n),"isEdit",f,j()(n)),n}return N()(t)}(Z.KZ9),g=R()(d.prototype,"mimeType",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"text/x-markdown"}}),f=R()(d.prototype,"isEdit",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d))||h)||h)||h)||h),y=W.R.create().register(Zt,we,u).register({token:H,useFactory:function(r){return function(t){var o=r.container.createChild();o.register({token:Z.seq,useValue:t});var n=o.get(u);return n}}})},40256:function(Qe,ne,e){e.d(ne,{ux:function(){return it},nR:function(){return V},qi:function(){return jt}});var Z=e(4977),W=e.n(Z),X=e(78796),D=e.n(X),K=e(41553),N=e.n(K),_=e(49488),E=e.n(_),w=e(84047),H=e.n(w),G=e(10154),k=e.n(G),oe=e(45332),j=e.n(oe),I=e(58601),Q=e(38168),le=e(91798),ce=e(22326),Ae=e(90361),R=e(47302),Y=e(53353),B=e(7317),ee=e(87933),ue=e(58757),L=e(90819),C=e.n(L),Ye=e(89933),P=e.n(Ye),Je=e(26336),me=e.n(Je),St=e(62055),he=e.n(St),de=e(23202),ge=e(79239),Xe=e(95881),qe,se,p,pe,_e,ye,et,tt,nt,ot,be,Ue,$,re,s,Te,Le,rt,ve="/",fe=".ipynb",V=(qe=(0,R.ri)(),se=function(m,i){return(0,R.f3)(I.QY6)(m,void 0,0)},p=Reflect.metadata("design:type",Function),pe=Reflect.metadata("design:paramtypes",[typeof I.QY6=="undefined"?Object:I.QY6]),_e=(0,Q.vg)(),ye=Reflect.metadata("design:type",Array),et=(0,Q.vg)(),tt=Reflect.metadata("design:type",typeof IContentsModel=="undefined"?Object:IContentsModel),nt=(0,Q.vg)(),ot=Reflect.metadata("design:type",typeof LibroView=="undefined"?Object:LibroView),be=(0,Q.vg)(),Ue=Reflect.metadata("design:type",Object),qe($=se($=p($=pe($=(re=function(){function x(m){D()(this,x),k()(this,"contentsManager",void 0),k()(this,"onNotebookFileChangedEmitter",new ge.Q5),k()(this,"onNotebookFileChanged",this.onNotebookFileChangedEmitter.event),me()(this,"notebookFileList",s,this),me()(this,"currentNotebookFile",Te,this),me()(this,"currentLibroView",Le,this),me()(this,"renameNotebookFile",rt,this),this.contentsManager=m}return W()(x,[{key:"openFile",value:function(i){if(this.currentNotebookFile!==i){var h=this.currentNotebookFile;this.currentNotebookFile=i,this.onNotebookFileChangedEmitter.fire({pre:h,cur:i})}}},{key:"getFileList",value:function(){var m=P()(C()().mark(function h(){var d,g;return C()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.contentsManager.get(ve);case 2:d=u.sent,g=d.content.filter(function(y){return y.name.endsWith(fe)}),this.notebookFileList=g.sort(function(y,l){return y.name.localeCompare(l.name)});case 5:case"end":return u.stop()}},h,this)}));function i(){return m.apply(this,arguments)}return i}()},{key:"renameFile",value:function(){var m=P()(C()().mark(function h(){var d,g,f,u,y,l,r,t;return C()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.renameNotebookFile){n.next=18;break}if(d=this.renameNotebookFile,g=d.path,f=d.name,!(g&&f)){n.next=18;break}if(u=this.getFileByPath(g),!u){n.next=18;break}if(u.name===f){n.next=18;break}return l=g.replace(u.name,f),n.next=9,this.isFileExisted(l);case 9:if(r=n.sent,!r){n.next=12;break}throw new Error("The notebook is already existed.");case 12:return n.next=14,this.contentsManager.rename(g,l);case 14:return t=n.sent,n.next=17,this.getFileList();case 17:((y=this.currentNotebookFile)===null||y===void 0?void 0:y.path)===g&&(this.currentNotebookFile=t);case 18:this.renameNotebookFile=null;case 19:case"end":return n.stop()}},h,this)}));function i(){return m.apply(this,arguments)}return i}()},{key:"addFile",value:function(){var m=P()(C()().mark(function h(){var d;return C()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.contentsManager.newUntitled({path:ve,type:"notebook"});case 2:return d=f.sent,f.next=5,this.getFileList();case 5:this.openFile(d),this.renameNotebookFile=this.createRenameNoteBookFile(d);case 7:case"end":return f.stop()}},h,this)}));function i(){return m.apply(this,arguments)}return i}()},{key:"deleteFile",value:function(){var m=P()(C()().mark(function h(d){var g;return C()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.contentsManager.delete(d.path);case 2:return u.next=4,this.getFileList();case 4:((g=this.currentNotebookFile)===null||g===void 0?void 0:g.path)===d.path&&(this.currentNotebookFile=null);case 5:case"end":return u.stop()}},h,this)}));function i(h){return m.apply(this,arguments)}return i}()},{key:"exportFile",value:function(){var m=P()(C()().mark(function h(d){var g;return C()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.contentsManager.getDownloadUrl(d.path);case 2:g=u.sent,(0,Xe.$A)(g,d.name);case 4:case"end":return u.stop()}},h,this)}));function i(h){return m.apply(this,arguments)}return i}()},{key:"copyFile",value:function(){var m=P()(C()().mark(function h(d){var g;return C()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.contentsManager.copy(d.path,ve);case 2:return g=u.sent,u.next=5,this.getFileList();case 5:this.openFile(g);case 6:case"end":return u.stop()}},h,this)}));function i(h){return m.apply(this,arguments)}return i}()},{key:"isFileExisted",value:function(){var m=P()(C()().mark(function h(d){var g;return C()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.contentsManager.get(ve);case 2:return g=u.sent,u.abrupt("return",g.content.some(function(y){return y.path===d}));case 4:case"end":return u.stop()}},h,this)}));function i(h){return m.apply(this,arguments)}return i}()},{key:"uploadFile",value:function(){var m=P()(C()().mark(function h(d,g){var f;return C()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return f="".concat(ve).concat(d),y.next=3,this.contentsManager.save(f,{type:"notebook",content:JSON.parse(g),format:"json"});case 3:return y.next=5,this.getFileList();case 5:case"end":return y.stop()}},h,this)}));function i(h,d){return m.apply(this,arguments)}return i}()},{key:"getFileByPath",value:function(i){return this.notebookFileList.find(function(h){return h.path===i})}},{key:"createRenameNoteBookFile",value:function(i){return{path:i.path,name:i.name}}},{key:"getFileNameWithoutExt",value:function(i){return i?i.endsWith(fe)?i.replace(fe,""):i:""}},{key:"getFileNameWithExt",value:function(i){return i?i.endsWith(fe)?i:"".concat(i).concat(fe):""}}]),x}(),s=he()(re.prototype,"notebookFileList",[_e,ye],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Te=he()(re.prototype,"currentNotebookFile",[et,tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Le=he()(re.prototype,"currentLibroView",[nt,ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=he()(re.prototype,"renameNotebookFile",[be,Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re))||$)||$)||$)||$),U=e(35667),Me,Ee,Oe,Re,Ze,Ce,Ie,z,it=function(x){return x.welcome="welcome",x}({}),At=function(){var m=(0,ue.useState)(void 0),i=j()(m,2),h=i[0],d=i[1],g=(0,Q.oC)(le.yd),f=g.notebookFileService.currentNotebookFile;return(0,ue.useEffect)(function(){if(f){var u={id:f.path,resource:f.path};g.libroService.getOrCreateView(u).then(function(y){y&&(g.notebookFileService.currentLibroView=y,d(y))}).catch(function(y){console.error("getOrCreateView fail",y)})}},[f,g]),!f||!h||!h.view?(0,U.jsx)(ce.g,{name:it.welcome}):(0,U.jsx)(Ae.o,{view:h})},at=(Me=(0,R.ri)(),Ee=(0,Y.ei)("secretnote-editor-view"),Oe=function(m,i){return(0,R.f3)(V)(m,void 0,0)},Re=function(m,i){return(0,R.f3)(I.W$M)(m,void 0,1)},Ze=function(m,i){return(0,R.f3)(B.v)(m,void 0,2)},Ce=Reflect.metadata("design:type",Function),Ie=Reflect.metadata("design:paramtypes",[typeof V=="undefined"?Object:V,typeof I.W$M=="undefined"?Object:I.W$M,typeof B.v=="undefined"?Object:B.v]),Me(z=Ee(z=Oe(z=Re(z=Ze(z=Ce(z=Ie(z=function(x){E()(i,x);var m=H()(i);function i(h,d,g){var f;return D()(this,i),f=m.call(this,void 0,g),k()(N()(f),"view",At),k()(N()(f),"notebookFileService",void 0),k()(N()(f),"libroService",void 0),f.notebookFileService=h,f.libroService=d,f}return W()(i)}(ee.W$))||z)||z)||z)||z)||z)||z)||z),Ut=e(84880),lt=e(20904),Tt=e(73193),st=e.n(Tt),ct=e(99138),O=e(64495),ze=e(20376),ut=e(8328),Lt=e(44549),dt=e(84743),Mt=e(52882),Et=e(52396),Ot=e(99997),vt,ft,mt,ht,gt,J,Rt=function(){var m=(0,Q.oC)(le.yd),i=function(){var d=P()(C()().mark(function g(f){var u;return C()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,Xe.pJ)(f);case 2:return u=l.sent,l.next=5,m.notebookFileService.uploadFile(f.name,u);case 5:ze.ZP.success(O.U6.t("Notebook \u4E0A\u4F20\u6210\u529F"));case 6:case"end":return l.stop()}},g)}));return function(f){return d.apply(this,arguments)}}(),h={accept:".ipynb",beforeUpload:function(){var d=P()(C()().mark(function f(u){var y;return C()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,m.notebookFileService.isFileExisted(u.name);case 2:if(y=r.sent,!y){r.next=7;break}ut.Z.confirm({title:O.U6.t("\u4E0A\u4F20 Notebook"),centered:!0,content:O.U6.t("Notebook {name} \u5DF2\u7ECF\u5B58\u5728\uFF0C\u662F\u5426\u8986\u76D6\u5B83\uFF1F",{name:u.name}),okText:O.U6.t("\u8986\u76D6"),cancelText:O.U6.t("\u53D6\u6D88"),okType:"danger",onOk:function(o){return P()(C()().mark(function n(){return C()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,i(u);case 2:return c.abrupt("return",o(Promise.resolve));case 3:case"end":return c.stop()}},n)}))()}}),r.next=9;break;case 7:return r.next=9,i(u);case 9:return r.abrupt("return",!1);case 10:case"end":return r.stop()}},f)}));function g(f){return d.apply(this,arguments)}return g}(),fileList:[]};return(0,U.jsxs)(Lt.Z,{style:{display:"flex",alignItems:"center"},children:[(0,U.jsx)(dt.Z,{title:O.U6.t("\u4E0A\u4F20 Notebook"),children:(0,U.jsx)("span",{onClick:function(g){return g.stopPropagation()},children:(0,U.jsx)(Mt.Z,st()(st()({},h),{},{children:(0,U.jsx)(Et.Z,{size:14})}))})}),(0,U.jsx)(dt.Z,{title:O.U6.t("\u65B0\u5EFA Notebook"),children:(0,U.jsx)(Ot.Z,{size:14,onClick:function(g){g.stopPropagation(),m.notebookFileService.addFile()}})})]})},pt=(vt=(0,R.ri)(),ft=(0,Y.ei)("secretnote-notebook-extra-view"),mt=function(m,i){return(0,R.f3)(V)(m,void 0,0)},ht=Reflect.metadata("design:type",Function),gt=Reflect.metadata("design:paramtypes",[typeof V=="undefined"?Object:V]),vt(J=ft(J=mt(J=ht(J=gt(J=function(x){E()(i,x);var m=H()(i);function i(h){var d;return D()(this,i),d=m.call(this),k()(N()(d),"view",Rt),k()(N()(d),"notebookFileService",void 0),d.notebookFileService=h,d}return W()(i)}(ct.P))||J)||J)||J)||J)||J),yt=e(36756),bt=e(64940),Ct=e(51865),kt=e.n(Ct),ke=e(18034),xe=e(67700),xt=e(39926),Ft=e(80808),Nt=e(16108),we,Pe,De,He,Be,M,Zt=function(){var m=(0,Q.oC)(le.yd),i=m.notebookFileService,h=ue.useRef(null),d=function(u,y){switch(u){case"rename":i.renameNotebookFile=i.createRenameNoteBookFile(y);break;case"delete":ut.Z.confirm({title:O.U6.t("\u5220\u9664 Notebook"),centered:!0,content:O.U6.t("Notebook {name} \u5C06\u88AB\u5220\u9664",{name:i.getFileNameWithoutExt(y.name)}),okText:O.U6.t("\u5220\u9664 Notebook"),cancelText:O.U6.t("\u53D6\u6D88"),okType:"danger",onOk:function(r){return P()(C()().mark(function t(){return C()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.deleteFile(y);case 2:return ze.ZP.success(O.U6.t("Notebook \u5220\u9664\u6210\u529F")),n.abrupt("return",r(Promise.resolve));case 4:case"end":return n.stop()}},t)}))()}});break;case"export":i.exportFile(y);break;case"copy":i.copyFile(y);break;default:break}},g=function(){var f=P()(C()().mark(function u(){return C()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,i.renameFile();case 3:l.next=8;break;case 5:l.prev=5,l.t0=l.catch(0),l.t0 instanceof Error&&(ze.ZP.error(l.t0.message),i.renameNotebookFile=null);case 8:case"end":return l.stop()}},u,null,[[0,5]])}));return function(){return f.apply(this,arguments)}}();return(0,U.jsx)("ul",{className:"secretnote-notebook-list",children:i.notebookFileList.map(function(f){var u,y,l;return(0,U.jsx)(yt.Z,{content:(0,U.jsx)(bt.Z,{ref:h,value:i.getFileNameWithoutExt((u=i.renameNotebookFile)===null||u===void 0?void 0:u.name),onChange:function(t){i.renameNotebookFile&&(i.renameNotebookFile.name=i.getFileNameWithExt(t.target.value))},onKeyDown:function(t){t.key==="Enter"&&g()}}),open:((y=i.renameNotebookFile)===null||y===void 0?void 0:y.path)===f.path,placement:"right",overlayClassName:"secretnote-notebook-list-popover",trigger:["click"],afterOpenChange:function(t){if(t){var o;(o=h.current)===null||o===void 0||o.select()}},onOpenChange:function(t){t||g()},arrow:!1,children:(0,U.jsxs)("li",{onClick:function(){return i.openFile(f)},className:kt()({current:((l=i.currentNotebookFile)===null||l===void 0?void 0:l.path)===f.path}),children:[(0,U.jsx)("span",{children:i.getFileNameWithoutExt(f.name)}),(0,U.jsx)(Nt.h,{items:[{key:"rename",label:O.U6.t("\u91CD\u547D\u540D"),icon:(0,U.jsx)(ke.Z,{size:12})},{key:"copy",label:O.U6.t("\u590D\u5236"),icon:(0,U.jsx)(xe.Z,{size:12})},{key:"export",label:O.U6.t("\u5BFC\u51FA\u4E3A .ipynb \u6587\u4EF6"),icon:(0,U.jsx)(xt.Z,{size:12})},{type:"divider"},{key:"delete",label:O.U6.t("\u5220\u9664"),icon:(0,U.jsx)(Ft.Z,{size:12}),danger:!0}],onClick:function(t){d(t,f)}})]})},f.path)})})},Fe="notebook",$e=(we=(0,R.ri)({contrib:[lt.cI]}),Pe=(0,Y.ei)("secretnote-notebook-view"),De=function(m,i){return(0,R.f3)(V)(m,void 0,0)},He=Reflect.metadata("design:type",Function),Be=Reflect.metadata("design:paramtypes",[typeof V=="undefined"?Object:V]),we(M=Pe(M=De(M=He(M=Be(M=function(x){E()(i,x);var m=H()(i);function i(h){var d;return D()(this,i),d=m.call(this),k()(N()(d),"key",Fe),k()(N()(d),"label","Notebooks"),k()(N()(d),"order",1),k()(N()(d),"defaultOpen",!0),k()(N()(d),"view",Zt),k()(N()(d),"notebookFileService",void 0),d.notebookFileService=h,d.notebookFileService.getFileList(),d}return W()(i)}(ct.P))||M)||M)||M)||M)||M),jt=Ut.R.create().register(at,$e,pt,V,(0,Y.vk)({slot:lt.gY.main,view:at}),(0,Y.bQ)({slot:Fe,view:$e,autoCreate:!0}),(0,Y.bQ)({slot:"".concat(Fe,"Extra"),view:pt,autoCreate:!0}))},97341:function(Qe,ne,e){e.d(ne,{O:function(){return G}});var Z=e(84880),W=e(78796),X=e.n(W),D=e(4977),K=e.n(D),N=e(47302),_=e(44054),E,w,H=(E=(0,N.ri)({contrib:_.z}),E(w=function(){function k(){X()(this,k)}return K()(k,[{key:"registerColors",value:function(j){j.register({id:"secretnote.sidebar.background",defaults:{dark:"#f4f6f8",light:"#f4f6f8"},description:""}),j.register({id:"secretnote.text.color",defaults:{dark:"#40566c",light:"#40566c"},description:""}),j.register({id:"secretnote.li.hover.background",defaults:{dark:"#e5ebf1",light:"#e5ebf1"},description:""}),j.register({id:"secretnote.icon.color",defaults:{dark:"#40566c",light:"#40566c"},description:""}),j.register({id:"secretnote.icon.hover.color",defaults:{dark:"#182431",light:"#182431"},description:""}),j.register({id:"secretnote.divider.color",defaults:{dark:"#d6dee6",light:"#d6dee6"},description:""})}}]),k}())||w),G=Z.R.create().register(H)},352:function(Qe,ne,e){e.d(ne,{V:function(){return R}});var Z=e(84880),W=e(78796),X=e.n(W),D=e(4977),K=e.n(D),N=e(58601),_=e(47302),E=e(62402),w=e(38168),H=e(91798),G=e(17313),k=e(64495),oe=e(84743),j=e(88890),I=e(35667),Q=function(){var B=(0,w.oC)(H.yd),ee=B?B.model:void 0,ue=(0,w.oC)(G.H),L=ee?ee.isKernelIdle:!1;return L?(0,I.jsx)(oe.Z,{placement:"left",autoAdjustOverflow:!1,overlayClassName:"libro-tooltip-placement-right",title:(0,I.jsxs)("span",{children:[(0,I.jsx)("div",{children:k.U6.t("\u8FD0\u884C")}),(0,I.jsx)("div",{children:"\u2318 \u21B5"})]}),children:(0,I.jsx)(j.Z,{size:16,onClick:function(){return ue.executeCommand(N.NzD.RunCell.id)}})}):(0,I.jsx)(oe.Z,{overlayClassName:"libro-tooltip-placement-right",placement:"right",title:k.U6.t("kernel\u51C6\u5907\u4E2D\uFF0C\u65E0\u6CD5\u6267\u884C"),children:(0,I.jsx)(j.Z,{size:16,color:"#bfbfbf"})})},le,ce,Ae=(le=(0,_.ri)({contrib:E.H}),le(ce=function(){function Y(){X()(this,Y)}return K()(Y,[{key:"registerToolbarItems",value:function(ee){ee.unregisterItem(N.cb8.ShowKernelStatusAndSelector.id),ee.unregisterItem(N.NzD.SideToolbarRunSelect.id),ee.registerItem({id:N.NzD.SideToolbarRunSelect.id,command:N.NzD.SideToolbarRunSelect.id,icon:Q,showLabelInline:!0,group:["sidetoolbar1"],order:"a"})}}]),Y}())||ce),R=Z.R.create().register(Ae)}}]);
