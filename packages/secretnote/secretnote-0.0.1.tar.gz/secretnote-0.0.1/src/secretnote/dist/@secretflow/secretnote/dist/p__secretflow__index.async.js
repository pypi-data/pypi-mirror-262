"use strict";(self.webpackChunk_secretflow_secretnote=self.webpackChunk_secretflow_secretnote||[]).push([[5987],{26529:function(Yr,Fe,c){c.r(Fe),c.d(Fe,{default:function(){return ye}});var bt=c(73193),De=c.n(bt),Ye=c(45332),v=c.n(Ye),we=c(23534),Qe=c(64256),f=c(68625),qe=c(11326),S=c(37678),V=c(58757),W=c(89428),et=c(65941),X=c(95831),tt=c(55844),T=c(86434),B=c(77014),je=c(78796),nt=c.n(je),_e=c(4977),rt=c.n(_e),P=c(10154),Re=c.n(P),G=function(){function A(){nt()(this,A),Re()(this,"_terminal",void 0),Re()(this,"_cacheDecorations",new Map),Re()(this,"_highlightTimeout",0)}return rt()(A,[{key:"activate",value:function(I){this._terminal=I}},{key:"_getLineProperty",value:function(I){for(var j=0,k=I.getCell(j),z=0,$=!0,R=!0;k;)k.isBgDefault()||($=!1),k.isFgDefault()||(R=!1),z+=k.getWidth(),k=I.getCell(j),j++;return{width:z,isAllBgDefault:$,isAllFgDefault:R}}},{key:"_decoration",value:function(I,j,k){if(this._terminal&&k&&k.decorations){var z=this._terminal,$=this._getLineProperty(I),R=$.width,Q=$.isAllBgDefault,q=$.isAllFgDefault;if(!(!Q||!q)){var oe=z.registerMarker(-z.buffer.active.baseY-z.buffer.active.cursorY+j);if(oe){var de={marker:oe,x:0,width:R,backgroundColor:k.decorations.matchBackground,foregroundColor:k.decorations.matchForegroundColor,layer:"bottom"},le=z.registerDecoration(de);le&&(le.onDispose(function(){oe.dispose()}),this._cacheDecorations.set(j,le))}}}}},{key:"_clearDecoration",value:function(){this._cacheDecorations.forEach(function(I){I.dispose()}),this._cacheDecorations.clear()}},{key:"_updateHighlight",value:function(I){var j=this;if(this._terminal&&Array.isArray(I)){this._clearDecoration();for(var k=this._terminal,z=0,$=k.buffer.active.getLine(z),R,Q=function(){var oe,de=k.buffer.active.getLine(z+1),le=de?de.isWrapped:!1,Me=(oe=$)===null||oe===void 0?void 0:oe.translateToString(!le);if(Me){var pe;if((pe=$)!==null&&pe!==void 0&&pe.isWrapped&&R)j._decoration($,z,R);else{var ke=I.find(function(be){var fe=be.keyword||"";if(be.ignoreSensitive){var Ce=Me.toLowerCase();return Ce.includes(fe.toLowerCase())||Ce.includes(fe)}return Me.includes(fe)});R=ke,j._decoration($,z,ke)}}z++,$=de};$;)Q()}}},{key:"highlight",value:function(I){var j=this;if(this._terminal&&Array.isArray(I)){this._cacheDecorations=new Map;var k=this._terminal;k.onWriteParsed(function(){clearTimeout(j._highlightTimeout),j._highlightTimeout=window.setTimeout(function(){j._updateHighlight(I)},0)}),k.onResize(function(){clearTimeout(j._highlightTimeout),j._highlightTimeout=window.setTimeout(function(){j._updateHighlight(I)},0)})}}},{key:"dispose",value:function(){clearTimeout(this._highlightTimeout),this._cacheDecorations.clear()}}]),A}();function at(A,F,I,j){var k=(0,V.useState)(),z=v()(k,2),$=z[0],R=z[1],Q=(0,V.useRef)(j);return(0,V.useEffect)(function(){Q.current=j}),(0,V.useEffect)(function(){var q=new F;return I&&A&&(A.loadAddon(q),R(q),Q.current instanceof Function&&Q.current(A,q)),function(){R(void 0),q.dispose()}},[A,F,I]),$}var C=at;function it(A,F){var I=(0,V.useRef)(A),j=(0,V.useRef)(0);return(0,V.useEffect)(function(){I.current=A}),(0,V.useEffect)(function(){return function(){clearTimeout(j.current)}},[]),(0,V.useCallback)(function(k){var z=k.target.value;clearTimeout(j.current),j.current=window.setTimeout(function(){I.current(z)},F)},[F])}var ue=it,st=c(23417),ce=function(F,I){var j=(0,V.useRef)(F);return(0,V.useEffect)(function(){j.current=F}),(0,V.useCallback)(function(){return(0,st.Z)(j.current,I)()},[I])},ot=ce,N=c(35667),Pe={regex:!1,wholeWord:!1,caseSensitive:!1,incremental:!1,decorations:{matchForegroundColor:"#000000",matchBackground:"#f6c8ac",matchBorder:"none",matchOverviewRuler:"none",activeMatchBackground:"#babfb1",activeMatchBorder:"none",activeMatchColorOverviewRuler:"none"}},M={cursorBlink:!1,convertEol:!1,scrollback:Number.MAX_SAFE_INTEGER,drawBoldTextInBrightColors:!1,allowProposedApi:!0,allowTransparency:!0,fontSize:13,fontFamily:"Roboto Mono,Andale Mono,Consolas,Courier New,monospace",lineHeight:20/17,fastScrollSensitivity:35},he=[{keyword:"[error]",ignoreSensitive:!0,decorations:{matchForegroundColor:"red",matchBackground:"#24292e"}},{keyword:"[warn]",ignoreSensitive:!0,decorations:{matchForegroundColor:"yellow",matchBackground:"#24292e"}},{keyword:"[debug]",ignoreSensitive:!0,decorations:{matchForegroundColor:"cyan",matchBackground:"#24292e"}}],ge=function(F){var I=(0,V.useState)(),j=v()(I,2),k=j[0],z=j[1],$=(0,V.useState)(""),R=v()($,2),Q=R[0],q=R[1],oe=(0,V.useState)({resultIndex:-1,resultCount:0}),de=v()(oe,2),le=de[0],Me=de[1],pe=(0,V.useRef)(null),ke=(0,V.useRef)(!1),be=F.theme||"dark",fe=(0,V.useRef)(0);(0,V.useEffect)(function(){var L=new W.Terminal(De()(De()({},M),{},{theme:be==="dark"?{selectionBackground:"#fff",selectionForeground:"#fff",background:"#24292e",foreground:"#b5bbc6"}:{selectionBackground:"#b7d7fb",selectionForeground:"#000",background:"#fff",foreground:"#000"}}));return z(L),function(){try{L.dispose()}catch(U){}}},[]),(0,V.useEffect)(function(){return pe.current&&k&&(k.open(pe.current),ke.current=!0),function(){k&&(k.clear(),ke.current=!1)}},[k]),C(k,et.CanvasAddon,!!k),C(k,T.WebLinksAddon,!!k);var Ce=C(k,X.FitAddon,!!k),ne=C(k,tt.SearchAddon,!!k,(0,V.useCallback)(function(L,U){var Se=U;Se&&Se.onDidChangeResults&&Se.onDidChangeResults(function(ct){Me(ct||{resultIndex:-1,resultCount:0})})},[]));C(k,G,!!k,function(L,U){var Se=U;Se&&Se.highlight(he)}),(0,V.useEffect)(function(){if(k)if(F.code.length===0){k.clear(),fe.current=0;return}else{var L=F.code.slice(fe.current);if(L.length>0){var U=L.join("").replaceAll(`
`,`\r
`);k.write(U),fe.current=F.code.length}}},[k,F.code]);var Ze=ot(function(){ke.current&&Ce&&Ce.fit&&Ce.fit()},3e3);(0,V.useEffect)(function(){var L=new ResizeObserver(Ze),U=pe.current;return U&&L.observe(U),function(){U&&(L.unobserve(U),L.disconnect())}},[Ce,Ze]);var lt=ue(function(L){ne&&ne.findNext(L,Pe)},800),ae=(0,V.useCallback)(function(){ne&&ne.findNext("",Pe)},[ne]),Ge=(0,V.useCallback)(function(L){ne&&ne.findPrevious(L,Pe)},[ne]),Ee=(0,V.useCallback)(function(L){ne&&ne.findNext(L,Pe)},[ne]),ut=(0,V.useCallback)(function(){k&&k.scrollToTop()},[k]),me=(0,V.useCallback)(function(){k&&k.scrollToBottom()},[k]),p=(0,N.jsxs)("div",{className:"terminal-viewer ".concat(be),children:[(0,N.jsx)("div",{className:"terminal-viewer-header",children:(0,N.jsxs)("div",{className:"terminal-viewer-input-wrapper",children:[(0,N.jsx)("input",{placeholder:"Search...",className:"terminal-viewer-input",value:Q,type:"text",onKeyDown:function(U){U.key==="Enter"&&Ee(Q)},onChange:function(U){q(U.target.value),lt(U)}}),(0,N.jsxs)("div",{className:"terminal-viewer-input-suffix",children:[Q&&(0,N.jsx)("span",{className:"input-suffix-search-result",children:le.resultCount}),(0,N.jsx)("span",{className:"input-suffix-clear",onClick:function(){q(""),ae()},children:(0,N.jsx)(we.Z,{size:16})}),(0,N.jsx)("span",{className:"input-suffix-search-tool",onClick:function(){return Ge(Q)},children:(0,N.jsx)(Qe.Z,{size:16})}),(0,N.jsx)("span",{className:"input-suffix-search-tool",onClick:function(){return Ee(Q)},children:(0,N.jsx)(f.Z,{size:16})})]})]})}),(0,N.jsx)("div",{className:"terminal-viewer-body",ref:pe}),(0,N.jsxs)("div",{className:"terminal-viewer-toolbar",children:[(0,N.jsx)("div",{className:"terminal-viewer-toolbar-button",onClick:ut,children:(0,N.jsx)(qe.Z,{size:16})}),(0,N.jsx)("div",{className:"terminal-viewer-toolbar-button",onClick:me,children:(0,N.jsx)(S.Z,{size:16})})]})]});return p},ye=ge},72612:function(Yr,Fe,c){c.r(Fe),c.d(Fe,{default:function(){return ni}});var bt=c(83109),De=c(43256),Ye=c(45362),v=c(58601),we=c(84880),Qe=c(90819),f=c.n(Qe),qe=c(89933),S=c.n(qe),V=c(78796),W=c.n(V),et=c(4977),X=c.n(et),tt=c(10154),T=c.n(tt),B=c(47302),je=Symbol("ComponentCellModelFactory"),nt=c(76711),_e=c.n(nt),rt=c(73193),P=c.n(rt),Re=c(26336),G=c.n(Re),at=c(41553),C=c.n(at),it=c(49488),ue=c.n(it),st=c(84047),ce=c.n(st),ot=c(62055),N=c.n(ot),Pe=c(23202),M=c(38168),he=c(91798),ge=c(53353),ye=c(17313),A=c(64495),F=c(20376),I=c(58757),j=c(64889),k=c(39566),z=c(34319),$=c(21381),R=c(38644),Q=c(58678),q=c(64940),oe=function(a){return a.atomic.allowedValues?a.atomic.allowedValues.ss:[]},de=function(a){switch(a.type){case"AT_BOOL":return"boolean";case"AT_INT":return"number";case"AT_STRING":return"string";case"AT_FLOAT":return"number"}return"string"},le=function(a,r){var n,e,t,i;switch(a.type){case"AT_BOOL":return(n=a.atomic)===null||n===void 0||(n=n[r])===null||n===void 0?void 0:n.b;case"AT_INT":return(e=a.atomic)===null||e===void 0||(e=e[r])===null||e===void 0?void 0:e.i64;case"AT_STRING":return(t=a.atomic)===null||t===void 0||(t=t[r])===null||t===void 0?void 0:t.s;case"AT_FLOAT":return(i=a.atomic)===null||i===void 0||(i=i[r])===null||i===void 0?void 0:i.f}},Me=function(a){return!a.atomic.isOptional},pe=function(a){if(a.atomic.lowerBoundEnabled)return Number(le(a,"lowerBound"))},ke=function(a){if(a.atomic.upperBoundEnabled)return Number(le(a,"upperBound"))},be=function(a,r,n){var e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"/",t=Array.isArray(r)?r:r.split(e),i=t.pop();if(i){var o=a;t.forEach(function(s){(o[s]===null||o[s]===void 0)&&(o[s]={}),o=o[s]}),o[i]=n}return a},fe=function(a,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"/",e,t=Array.isArray(r)?r:r.split(n);if(t.length)for(e=a;t.length;){var i=t.shift();if(Object(e)===e&&i&&i in e)e=e[i];else return}return e},Ce=function(a){var r={id:"$root",type:"object",title:"schema form",description:"",properties:{attrs:{id:"attrs",type:"object",title:"attrs",description:"",properties:{}},inputs:{id:"inputs",type:"object",title:"inputs",description:"",properties:{}},outputs:{id:"outputs",type:"object",title:"outputs",description:"",properties:{}}}};return(a.attrs||[]).forEach(function(n){var e=n.name,t=n.desc,i=de(n),o=oe(n),s={id:e,type:i,title:e,description:t,$componentType:o.length>0?"select":"input",$options:o.map(function(l){return{label:l,value:l}}),$defaultValue:le(n,"defaultValue"),$required:Me(n),minimum:pe(n),maximum:ke(n)};be(r,"properties/attrs/properties/".concat(e),s)}),(a.inputs||[]).forEach(function(n){var e=n.name,t={id:e,type:"object",title:e,description:n.desc,$componentType:"tableConfig",$inputTableConfig:{types:n.types,attrs:(n.attrs||[]).map(function(i){return i.name})}};be(r,"properties/inputs/properties/".concat(e),t)}),(a.outputs||[]).forEach(function(n){var e=n.name,t={id:["output",e],type:"string",description:n.desc,title:e,$required:!0};be(r,"properties/outputs/properties/".concat(e),t)}),r},ne=c(86222),Ze=c.n(ne),lt=c(45332),ae=c.n(lt),Ge=c(81590),Ee=c(36756),ut=c(83869),me=c(95881),p=c(35667),L={span:8},U={offset:4,span:12},Se=[{key:"features"},{key:"feature_types"},{key:"labels"},{key:"label_types"},{key:"ids"},{key:"id_types"}],ct=function(a){var r=a.value,n=a.onChange,e=function(i){var o,s=i;return r==null||(o=r[s])===null||o===void 0?void 0:o.join(",")};return(0,p.jsx)("span",{className:"schema-selector",children:Se.map(function(t){return(0,p.jsx)(R.Z.Item,{labelCol:L,wrapperCol:U,label:t.key,children:(0,p.jsx)(q.Z,{defaultValue:e(t.key),onChange:function(o){n&&n(T()({},t.key,o.target.value.split(",")))}})},t.key)})})},Qr=function(a){var r=(0,I.useState)(),n=ae()(r,2),e=n[0],t=n[1],i=function(){var d=S()(f()().mark(function y(){var g,w,b,E,m,O,Z,x,Ne;return f()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return g=[],w="api/nodes",b={method:"GET"},_.next=5,(0,me.WY)(w,b);case 5:E=_.sent,m=Ze()(E),_.prev=7,m.s();case 9:if((O=m.n()).done){_.next=18;break}return Z=O.value,x=Z.address,_.next=14,(0,me.WY)("http://".concat(x,"/api/contents"),{method:"GET"});case 14:Ne=_.sent,g.push({label:Z.name,value:Z.name,children:Ne.content.filter(function(ze){return ze.name.endsWith(".csv")}).map(function(ze){return{label:ze.name,value:ze.name}})});case 16:_.next=9;break;case 18:_.next=23;break;case 20:_.prev=20,_.t0=_.catch(7),m.e(_.t0);case 23:return _.prev=23,m.f(),_.finish(23);case 26:t(g);case 27:case"end":return _.stop()}},y,null,[[7,20,23,26]])}));return function(){return d.apply(this,arguments)}}();(0,I.useEffect)(function(){i()},[]);var o=function(y){var g,w=(((g=a.value)===null||g===void 0?void 0:g.data_ref)||[])[y];return w?[w.party,w.uri]:[]},s=function(y){var g,w=((g=a.value)===null||g===void 0?void 0:g.data_ref)||[];if(w.length>1){var b;return(b=a.value)===null||b===void 0||(b=b.schemas)===null||b===void 0?void 0:b[y]}else if(w.length===1){var E;return(E=a.value)===null||E===void 0?void 0:E.schema}},l=function(y,g){if(a.onChange)if(g&&g.length===2){var w,b=ae()(g,2),E=b[0],m=b[1],O=((w=a.value)===null||w===void 0?void 0:w.data_ref)||[];O[y]={uri:m,party:E},a.onChange(P()(P()({},a.value),{},{data_ref:O}))}else{var Z,x=((Z=a.value)===null||Z===void 0?void 0:Z.data_ref)||[];x.splice(y,1),a.onChange(P()(P()({},a.value),{},{data_ref:x}))}},h=function(y,g){if(a.onChange){var w,b=((w=a.value)===null||w===void 0?void 0:w.data_ref)||[];if(b.length>1){var E,m=((E=a.value)===null||E===void 0?void 0:E.schemas)||[];m[y]=P()(P()({},m[y]),g),a.onChange(P()(P()({},a.value),{},{schemas:m,schema:void 0}))}else if(b.length===1){var O;a.onChange(P()(P()({},a.value),{},{schema:P()(P()({},(O=a.value)===null||O===void 0?void 0:O.schema),g),schemas:void 0}))}}};return(0,p.jsx)("span",{children:e==null?void 0:e.map(function(d,y){return(0,p.jsx)("span",{className:"table-selector",children:d.children.length>0?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Ge.Z,{defaultValue:o(y),options:e,onChange:function(w){return l(y,w)}}),(0,p.jsx)(Ee.Z,{content:(0,p.jsx)(ct,{value:s(y),onChange:function(w){return h(y,w)}}),placement:"right",title:"",overlayClassName:"secretnote-table-selector-popover",trigger:"click",arrow:!1,children:(0,p.jsx)(ut.Z,{size:14,cursor:"pointer"})})]}):(0,p.jsx)("span",{className:"no-table",children:"No table to choose."},d.value)},d.value)})})},dt={span:8},pt={offset:4,span:12},qr={tableConfig:function(a){var r=a.root,n=fe(r,"$inputTableConfig/types"),e=fe(r,"$inputTableConfig/attrs"),t=function(){var o=a.form.getFieldValue(["input",r.id,"type"]);if(o)return o.split(".")[1]};return(0,p.jsxs)(R.Z.Item,{label:r.id,labelCol:{span:24},wrapperCol:{offset:1},className:"table-config-item",children:[(0,p.jsx)(R.Z.Item,{label:"type",name:["input",r.id,"type"],labelCol:dt,wrapperCol:pt,children:(0,p.jsx)(Q.Z,{options:n.map(function(i){return{label:i,value:i}})})}),e.map(function(i){return(0,p.jsx)(R.Z.Item,{label:i,name:"input/".concat(r.id,"/").concat(i),labelCol:dt,wrapperCol:pt,children:(0,p.jsx)(q.Z,{})},i)}),t()==="table"&&(0,p.jsx)(R.Z.Item,{label:"tables",name:["input",r.id,"tables"],labelCol:dt,wrapperCol:pt,dependencies:["input",r.id,"type"],children:(0,p.jsx)(Qr,{})})]},r.id)}},Ct=(0,I.forwardRef)(function(u,a){return(0,p.jsx)("div",{className:"component-form",children:(0,p.jsx)($.ZP,{ref:a,json:Ce(u.config),value:u.defaultValue,customComponent:qr,formOptions:{size:"small",layout:"horizontal",labelAlign:"left",labelCol:{span:8},wrapperCol:{span:12,offset:4},initialValues:u.defaultValue,onValuesChange:function(n,e){var t;console.log(e),(t=u.onValuesChange)===null||t===void 0||t.call(u,n,e)}}})})});Ct.displayName="ComponentForm";var ea=c(26529),ta=c(84176),na=c.n(ta),ra=["input","output"],aa={runtime_config:{protocol:"REF2K",field:"FM64"},link_desc:{connect_retry_times:60,connect_retry_interval_ms:1e3,brpc_channel_protocol:"http",brpc_channel_connection_type:"pooled",recv_timeout_ms:12e5,http_timeout_ms:12e5}},ia={public_config:{ray_fed_config:{parties:["alice","bob"],addresses:["alice:8000","bob:8000"]},spu_configs:[{name:"spu",parties:["alice","bob"],addresses:["alice:8001","bob:8001"]}]},private_config:{self_party:"{self_party}",ray_head_addr:"127.0.0.1:6379"},desc:{parties:["alice","bob"],devices:[{name:"spu",type:"spu",parties:["alice","bob"],config:JSON.stringify(aa)},{name:"heu",type:"heu",parties:[],config:JSON.stringify({mode:"PHEU",schema:"paillier",key_size:2048})}]}},sa=function(a,r,n){var e=(a.attrs||[]).find(function(i){return i.name===r});if(e){var t=e.type;switch(t){case"AT_INT":return{i64:n};case"AT_BOOL":return{b:n};case"AT_STRING":return{s:n};case"AT_FLOAT":return{f:n};default:return{s:n}}}else return{ss:(n||"").split(",")}},oa=function(a){return a==="sf.table.individual"?"type.googleapis.com/secretflow.spec.v1.IndividualTable":a==="sf.table.vertical_table"?"type.googleapis.com/secretflow.spec.v1.VerticalTable":""},wt=function(a,r){if(!(a&&r))return"";var n={domain:a.domain,name:a.name,version:a.version,attr_paths:[],attrs:[],inputs:[],output_uris:[]},e=r.input,t=r.output,i=na()(r,ra);return i&&Object.entries(i).forEach(function(o){var s=ae()(o,2),l=s[0],h=s[1];n.attr_paths.push(l);var d=sa(a,l,h);n.attrs.push(d)}),e&&Object.entries(e).forEach(function(o){var s=ae()(o,2),l=s[0],h=s[1],d=h.type,y=h.tables,g=d==="sf.table.individual"?"schema":"schemas";d&&y&&n.inputs.push({name:l,type:d,data_refs:y.data_ref.map(function(w){return{uri:w.uri,party:w.party,format:"csv"}}),meta:T()(T()({"@type":oa(d)},g,y[g]),"line_count",-1)})}),t&&Object.entries(t).forEach(function(o){var s=ae()(o,2),l=s[1];n.output_uris.push(l)}),`
    from secretflow.spec.v1.evaluation_pb2 import NodeEvalParam
    from secretflow.spec.extend.cluster_pb2 import SFClusterConfig
    from secretflow.component.entry import comp_eval
    from google.protobuf.json_format import Parse
    from secretflow.spec.v1.data_pb2 import StorageConfig
    import os

    cluster_config_str = r"""
    `.concat(JSON.stringify(ia),`
    """


    component_config_str = r"""
    `).concat(JSON.stringify(n),`
    """

    self_party = os.getenv("SELF_PARTY", "alice")
    cluster_config = SFClusterConfig()
    Parse(cluster_config_str.replace('{self_party}', self_party), cluster_config)

    node_eval_config = NodeEvalParam()
    Parse(component_config_str, node_eval_config)

    storage_config = StorageConfig(
        type="local_fs",
        local_fs=StorageConfig.LocalFSConfig(wd="/home/vscode/examples"),
    )

    res = comp_eval(node_eval_config, storage_config, cluster_config)

    print(f"The execution is complete and the result is: \\n{res}")
    `)},kt=c(86919),St=JSON.parse(`{"$9":[{"domain":"feature","name":"vert_bin_substitution","desc":"Substitute datasets' value by bin substitution rules.","version":"0.0.1","inputs":[{"name":"input_data","desc":"Vertical partitioning dataset to be substituted.","types":["sf.table.vertical_table"]},{"name":"bin_rule","desc":"Input bin substitution rule.","types":["sf.rule.binning"]}],"outputs":[{"name":"output_data","desc":"Output vertical table.","types":["sf.table.vertical_table"]}]},{"domain":"feature","name":"vert_binning","desc":"Generate equal frequency or equal range binning rules for vertical partitioning datasets.","version":"0.0.1","attrs":[{"name":"binning_method","desc":"How to bin features with numeric types: \\"quantile\\"(equal frequency)/\\"eq_range\\"(equal range)","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"eq_range"},"allowedValues":{"ss":["eq_range","quantile"]}}},{"name":"bin_num","desc":"Max bin counts for one features.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{}}}],"inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"which features should be binned.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"bin_rule","desc":"Output bin rule.","types":["sf.rule.binning"]}]},{"domain":"feature","name":"vert_woe_binning","desc":"Generate Weight of Evidence (WOE) binning rules for vertical partitioning datasets.","version":"0.0.1","attrs":[{"name":"secure_device_type","desc":"Use SPU(Secure multi-party computation or MPC) or HEU(Homomorphic encryption or HE) to secure bucket summation.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"spu"},"allowedValues":{"ss":["spu","heu"]}}},{"name":"binning_method","desc":"How to bin features with numeric types: \\"quantile\\"(equal frequency)/\\"chimerge\\"(ChiMerge from AAAI92-019: https://www.aaai.org/Papers/AAAI/1992/AAAI92-019.pdf)","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"quantile"},"allowedValues":{"ss":["quantile","chimerge"]}}},{"name":"bin_num","desc":"Max bin counts for one features.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"positive_label","desc":"Which value represent positive value in label.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"1"}}},{"name":"chimerge_init_bins","desc":"Max bin counts for initialization binning in ChiMerge.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"100"},"lowerBoundEnabled":true,"lowerBound":{"i64":"2"}}},{"name":"chimerge_target_bins","desc":"Stop merging if remaining bin counts is less than or equal to this value.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"2"},"lowerBoundInclusive":true}},{"name":"chimerge_target_pvalue","desc":"Stop merging if biggest pvalue of remaining bins is greater than this value.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}}],"inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"which features should be binned.","colMinCntInclusive":"1"},{"name":"label","desc":"Label of input data.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"bin_rule","desc":"Output WOE rule.","types":["sf.rule.binning"]}]},{"domain":"ml.eval","name":"biclassification_eval","desc":"Statistics evaluation for a bi-classification model on a dataset.\\n1. summary_report: SummaryReport\\n2. group_reports: List[GroupReport]\\n3. eq_frequent_bin_report: List[EqBinReport]\\n4. eq_range_bin_report: List[EqBinReport]\\n5. head_report: List[PrReport]\\nreports for fpr = 0.001, 0.005, 0.01, 0.05, 0.1, 0.2","version":"0.0.1","attrs":[{"name":"bucket_size","desc":"Number of buckets.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"min_item_cnt_per_bucket","desc":"Min item cnt per bucket. If any bucket doesn't meet the requirement, error raises. For security reasons, we require this parameter to be at least 5.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"5"},"lowerBoundEnabled":true,"lowerBound":{"i64":"5"},"lowerBoundInclusive":true}}],"inputs":[{"name":"labels","desc":"Input table with labels","types":["sf.table.vertical_table","sf.table.individual"],"attrs":[{"name":"col","desc":"The column name to use in the dataset. If not provided, the label of dataset will be used by default.","colMaxCntInclusive":"1"}]},{"name":"predictions","desc":"Input table with predictions","types":["sf.table.vertical_table","sf.table.individual"],"attrs":[{"name":"col","desc":"The column name to use in the dataset. If not provided, the label of dataset will be used by default.","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"reports","desc":"Output report.","types":["sf.report"]}]},{"domain":"ml.eval","name":"prediction_bias_eval","desc":"Calculate prediction bias, ie. average of predictions - average of labels.","version":"0.0.1","attrs":[{"name":"bucket_num","desc":"Num of bucket.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"min_item_cnt_per_bucket","desc":"Min item cnt per bucket. If any bucket doesn't meet the requirement, error raises. For security reasons, we require this parameter to be at least 2.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"2"},"lowerBoundEnabled":true,"lowerBound":{"i64":"2"},"lowerBoundInclusive":true}},{"name":"bucket_method","desc":"Bucket method.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"equal_width"},"allowedValues":{"ss":["equal_width","equal_frequency"]}}}],"inputs":[{"name":"labels","desc":"Input table with labels.","types":["sf.table.vertical_table","sf.table.individual"],"attrs":[{"name":"col","desc":"The column name to use in the dataset. If not provided, the label of dataset will be used by default.","colMaxCntInclusive":"1"}]},{"name":"predictions","desc":"Input table with predictions.","types":["sf.table.vertical_table","sf.table.individual"],"attrs":[{"name":"col","desc":"The column name to use in the dataset. If not provided, the label of dataset will be used by default.","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"result","desc":"Output report.","types":["sf.report"]}]},{"domain":"ml.eval","name":"ss_pvalue","desc":"Calculate P-Value for LR model training on vertical partitioning dataset by using secret sharing.\\nFor large dataset(large than 10w samples & 200 features),\\nrecommend to use [Ring size: 128, Fxp: 40] options for SPU device.","version":"0.0.1","inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_sgd"]},{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"report","desc":"Output P-Value report.","types":["sf.report"]}]},{"domain":"ml.predict","name":"sgb_predict","desc":"Predict using SGB model.","version":"0.0.1","attrs":[{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Name for prediction column","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"model","types":["sf.model.sgb"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.predict","name":"ss_glm_predict","desc":"Predict using the SSGLM model.","version":"0.0.1","attrs":[{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Column name for predictions.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"offset_col","desc":"Specify a column to use as the offset","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_glm"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.predict","name":"ss_sgd_predict","desc":"Predict using the SS-SGD model.","version":"0.0.1","attrs":[{"name":"batch_size","desc":"The number of training examples utilized in one iteration.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Column name for predictions.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_sgd"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.predict","name":"ss_xgb_predict","desc":"Predict using the SS-XGB model.","version":"0.0.1","attrs":[{"name":"receiver","desc":"Party of receiver.","type":"AT_STRING","atomic":{}},{"name":"pred_name","desc":"Column name for predictions.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"pred"}}},{"name":"save_ids","desc":"Whether to save ids columns into output prediction table. If true, input feature_dataset must contain id columns, and receiver party must be id owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"save_label","desc":"Whether or not to save real label columns into output pred file. If true, input feature_dataset must contain label columns and receiver party must be label owner.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"model","desc":"Input model.","types":["sf.model.ss_xgb"]},{"name":"feature_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"pred","desc":"Output prediction.","types":["sf.table.individual"]}]},{"domain":"ml.train","name":"sgb_train","desc":"Provides both classification and regression tree boosting (also known as GBDT, GBM)\\nfor vertical split dataset setting by using secure boost.\\n- SGB is short for SecureBoost. Compared to its safer counterpart SS-XGB, SecureBoost focused on protecting label holder.\\n- Check https://arxiv.org/abs/1901.08755.","version":"0.0.1","attrs":[{"name":"num_boost_round","desc":"Number of boosting iterations.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"max_depth","desc":"Maximum depth of a tree.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"5"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"16"},"upperBoundInclusive":true}},{"name":"learning_rate","desc":"Step size shrinkage used in update to prevent overfitting.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"objective","desc":"Specify the learning objective.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"logistic"},"allowedValues":{"ss":["linear","logistic"]}}},{"name":"reg_lambda","desc":"L2 regularization term on weights.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000},"upperBoundInclusive":true}},{"name":"gamma","desc":"Greater than 0 means pre-pruning enabled. If gain of a node is less than this value, it would be pruned.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000},"upperBoundInclusive":true}},{"name":"colsample_by_tree","desc":"Subsample ratio of columns when constructing each tree.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"sketch_eps","desc":"This roughly translates into O(1 / sketch_eps) number of bins.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"base_score","desc":"The initial prediction score of all instances, global bias.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"seed","desc":"Pseudorandom number generator seed.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"42"},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"fixed_point_parameter","desc":"Any floating point number encoded by heu, will multiply a scale and take the round, scale = 2 ** fixed_point_parameter. larger value may mean more numerical accuracy, but too large will lead to overflow problem.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"20"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"100"},"upperBoundInclusive":true}},{"name":"first_tree_with_label_holder_feature","desc":"Whether to train the first tree with label holder's own features.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"batch_encoding_enabled","desc":"If use batch encoding optimization.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{"b":true}}},{"name":"enable_quantization","desc":"Whether enable quantization of g and h.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"quantization_scale","desc":"Scale the sum of g to the specified value.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":10000},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000000},"upperBoundInclusive":true}},{"name":"max_leaf","desc":"Maximum leaf of a tree. Only effective if train leaf wise.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"15"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"32768"},"upperBoundInclusive":true}},{"name":"rowsample_by_tree","desc":"Row sub sample ratio of the training instances.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"enable_goss","desc":"Whether to enable GOSS.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"top_rate","desc":"GOSS-specific parameter. The fraction of large gradients to sample.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.3},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"bottom_rate","desc":"GOSS-specific parameter. The fraction of small gradients to sample.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.5},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"early_stop_criterion_g_abs_sum","desc":"If sum(abs(g)) is lower than or equal to this threshold, training will stop.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"early_stop_criterion_g_abs_sum_change_ratio","desc":"If absolute g sum change ratio is lower than or equal to this threshold, training will stop.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"tree_growing_method","desc":"How to grow tree?","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"level"}}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.sgb"]}]},{"domain":"ml.train","name":"ss_glm_train","desc":"generalized linear model (GLM) is a flexible generalization of ordinary linear regression.\\nThe GLM generalizes linear regression by allowing the linear model to be related to the response\\nvariable via a link function and by allowing the magnitude of the variance of each measurement to\\nbe a function of its predicted value.","version":"0.0.1","attrs":[{"name":"epochs","desc":"The number of complete pass through the training data.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"learning_rate","desc":"The step size at each iteration in one iteration.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"batch_size","desc":"The number of training examples utilized in one iteration.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"link_type","desc":"link function type","type":"AT_STRING","atomic":{"allowedValues":{"ss":["Logit","Log","Reciprocal","Indentity"]}}},{"name":"label_dist_type","desc":"label distribution type","type":"AT_STRING","atomic":{"allowedValues":{"ss":["Bernoulli","Poisson","Gamma","Tweedie"]}}},{"name":"tweedie_power","desc":"Tweedie distribution power parameter","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":2},"upperBoundInclusive":true}},{"name":"dist_scale","desc":"A guess value for distribution's scale","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":1},"lowerBoundEnabled":true,"lowerBound":{"f":1},"lowerBoundInclusive":true}},{"name":"eps","desc":"If the change rate of weights is less than this threshold, the model is considered to be converged, and the training stops early. 0 to disable.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.0001},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"iter_start_irls","desc":"run a few rounds of IRLS training as the initialization of w, 0 disable","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"decay_epoch","desc":"decay learning interval","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"decay_rate","desc":"decay learning rate","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1}}},{"name":"optimizer","desc":"which optimizer to use: IRLS(Iteratively Reweighted Least Squares) or SGD(Stochastic Gradient Descent)","type":"AT_STRING","atomic":{"allowedValues":{"ss":["SGD","IRLS"]}}},{"name":"offset_col","desc":"Specify a column to use as the offset","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"weight_col","desc":"Specify a column to use for the observation weights","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{}}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.ss_glm"]}]},{"domain":"ml.train","name":"ss_sgd_train","desc":"Train both linear and logistic regression\\nlinear models for vertical partitioning dataset with mini batch SGD training solver by using secret sharing.\\n- SS-SGD is short for secret sharing SGD training.","version":"0.0.1","attrs":[{"name":"epochs","desc":"The number of complete pass through the training data.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"learning_rate","desc":"The step size at each iteration in one iteration.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"batch_size","desc":"The number of training examples utilized in one iteration.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"sig_type","desc":"Sigmoid approximation type.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"t1"},"allowedValues":{"ss":["real","t1","t3","t5","df","sr","mix"]}}},{"name":"reg_type","desc":"Regression type","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"logistic"},"allowedValues":{"ss":["linear","logistic"]}}},{"name":"penalty","desc":"The penalty(aka regularization term) to be used.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"None"},"allowedValues":{"ss":["None","l1","l2"]}}},{"name":"l2_norm","desc":"L2 regularization term.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.5},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"eps","desc":"If the change rate of weights is less than this threshold, the model is considered to be converged, and the training stops early. 0 to disable.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.001},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.ss_sgd"]}]},{"domain":"ml.train","name":"ss_xgb_train","desc":"This method provides both classification and regression tree boosting (also known as GBDT, GBM)\\nfor vertical partitioning dataset setting by using secret sharing.\\n- SS-XGB is short for secret sharing XGB.\\n- More details: https://arxiv.org/pdf/2005.08479.pdf","version":"0.0.1","attrs":[{"name":"num_boost_round","desc":"Number of boosting iterations.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true}},{"name":"max_depth","desc":"Maximum depth of a tree.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"5"},"lowerBoundEnabled":true,"lowerBound":{"i64":"1"},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"i64":"16"},"upperBoundInclusive":true}},{"name":"learning_rate","desc":"Step size shrinkage used in updates to prevent overfitting.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"objective","desc":"Specify the learning objective.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"logistic"},"allowedValues":{"ss":["linear","logistic"]}}},{"name":"reg_lambda","desc":"L2 regularization term on weights.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":10000},"upperBoundInclusive":true}},{"name":"subsample","desc":"Subsample ratio of the training instances.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"colsample_by_tree","desc":"Subsample ratio of columns when constructing each tree.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"sketch_eps","desc":"This roughly translates into O(1 / sketch_eps) number of bins.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.1},"lowerBoundEnabled":true,"lowerBound":{},"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"base_score","desc":"The initial prediction score of all instances, global bias.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}},{"name":"seed","desc":"Pseudorandom number generator seed.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"42"},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true}}],"inputs":[{"name":"train_dataset","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"label","desc":"Label of train dataset.","colMinCntInclusive":"1","colMaxCntInclusive":"1"}]}],"outputs":[{"name":"output_model","desc":"Output model.","types":["sf.model.ss_xgb"]}]},{"domain":"preprocessing","name":"feature_filter","desc":"Drop features from the dataset.","version":"0.0.1","inputs":[{"name":"in_ds","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"drop_features","desc":"Features to drop."}]}],"outputs":[{"name":"out_ds","desc":"Output vertical table.","types":["sf.table.vertical_table"]}]},{"domain":"preprocessing","name":"psi","desc":"PSI between two parties.","version":"0.0.1","attrs":[{"name":"protocol","desc":"PSI protocol.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"ECDH_PSI_2PC"},"allowedValues":{"ss":["ECDH_PSI_2PC","KKRT_PSI_2PC","BC22_PSI_2PC"]}}},{"name":"sort","desc":"Sort the output.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{}}},{"name":"bucket_size","desc":"Specify the hash bucket size used in PSI. Larger values consume more memory.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1048576"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"ecdh_curve_type","desc":"Curve type for ECDH PSI.","type":"AT_STRING","atomic":{"isOptional":true,"defaultValue":{"s":"CURVE_FOURQ"},"allowedValues":{"ss":["CURVE_25519","CURVE_FOURQ","CURVE_SM2","CURVE_SECP256K1"]}}}],"inputs":[{"name":"receiver_input","desc":"Individual table for receiver","types":["sf.table.individual"],"attrs":[{"name":"key","desc":"Column(s) used to join.","colMinCntInclusive":"1"}]},{"name":"sender_input","desc":"Individual table for sender","types":["sf.table.individual"],"attrs":[{"name":"key","desc":"Column(s) used to join.","colMinCntInclusive":"1"}]}],"outputs":[{"name":"psi_output","desc":"Output vertical table","types":["sf.table.vertical_table"]}]},{"domain":"preprocessing","name":"train_test_split","desc":"Split datasets into random train and test subsets.\\n- Please check: https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html","version":"0.0.1","attrs":[{"name":"train_size","desc":"Proportion of the dataset to include in the train subset.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.75},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"test_size","desc":"Proportion of the dataset to include in the test subset.","type":"AT_FLOAT","atomic":{"isOptional":true,"defaultValue":{"f":0.25},"lowerBoundEnabled":true,"lowerBound":{},"lowerBoundInclusive":true,"upperBoundEnabled":true,"upperBound":{"f":1},"upperBoundInclusive":true}},{"name":"random_state","desc":"Specify the random seed of the shuffling.","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"1024"},"lowerBoundEnabled":true,"lowerBound":{}}},{"name":"shuffle","desc":"Whether to shuffle the data before splitting.","type":"AT_BOOL","atomic":{"isOptional":true,"defaultValue":{"b":true}}}],"inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"]}],"outputs":[{"name":"train","desc":"Output train dataset.","types":["sf.table.vertical_table"]},{"name":"test","desc":"Output test dataset.","types":["sf.table.vertical_table"]}]},{"domain":"stats","name":"groupby_statistics","desc":"Get a groupby of statistics, like pandas groupby statistics.\\nCurrently only support VDataframe.","version":"0.0.1","attrs":[{"name":"agg","desc":"What kind of aggregation statistics we want to do, currently only supports min, max, mean, sum, var, count(number of elements in each group)","type":"AT_STRING","atomic":{"allowedValues":{"ss":["min","max","mean","sum","var","count"]}}},{"name":"max_group_size","desc":"The maximum number of groups allowed","type":"AT_INT","atomic":{"isOptional":true,"defaultValue":{"i64":"10000"},"lowerBoundEnabled":true,"lowerBound":{}}}],"inputs":[{"name":"input_data","desc":"Input table.","types":["sf.table.vertical_table","sf.table.individual"],"attrs":[{"name":"by","desc":"by what columns should we group the values","colMinCntInclusive":"1","colMaxCntInclusive":"4"},{"name":"values","desc":"on which columns should we calculate the statistics","colMinCntInclusive":"1"}]}],"outputs":[{"name":"report","desc":"Output groupby statistics report.","types":["sf.report"]}]},{"domain":"stats","name":"ss_pearsonr","desc":"Calculate Pearson's product-moment correlation coefficient for vertical partitioning dataset\\nby using secret sharing.\\n- For large dataset(large than 10w samples & 200 features), recommend to use [Ring size: 128, Fxp: 40] options for SPU device.","version":"0.0.1","inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"Specify which features to calculate correlation coefficient with. If empty, all features will be used"}]}],"outputs":[{"name":"report","desc":"Output Pearson's product-moment correlation coefficient report.","types":["sf.report"]}]},{"domain":"stats","name":"ss_vif","desc":"Calculate Variance Inflation Factor(VIF) for vertical partitioning dataset\\nby using secret sharing.\\n- For large dataset(large than 10w samples & 200 features), recommend to use [Ring size: 128, Fxp: 40] options for SPU device.","version":"0.0.1","inputs":[{"name":"input_data","desc":"Input vertical table.","types":["sf.table.vertical_table"],"attrs":[{"name":"feature_selects","desc":"Specify which features to calculate VIF with. If empty, all features will be used."}]}],"outputs":[{"name":"report","desc":"Output Variance Inflation Factor(VIF) report.","types":["sf.report"]}]},{"domain":"stats","name":"table_statistics","desc":"Get a table of statistics,\\nincluding each column's\\n1. datatype\\n2. total_count\\n3. count\\n4. count_na\\n5. min\\n6. max\\n7. var\\n8. std\\n9. sem\\n10. skewness\\n11. kurtosis\\n12. q1\\n13. q2\\n14. q3\\n15. moment_2\\n16. moment_3\\n17. moment_4\\n18. central_moment_2\\n19. central_moment_3\\n20. central_moment_4\\n21. sum\\n22. sum_2\\n23. sum_3\\n24. sum_4\\n- moment_2 means E[X^2].\\n- central_moment_2 means E[(X - mean(X))^2].\\n- sum_2 means sum(X^2).","version":"0.0.1","inputs":[{"name":"input_data","desc":"Input table.","types":["sf.table.vertical_table","sf.table.individual"]}],"outputs":[{"name":"report","desc":"Output table statistics report.","types":["sf.report"]}]}]}`),la=function(a){var r=[],n=(0,kt.Z)(a,"domain");return Object.keys(n).forEach(function(e){var t=n[e],i={value:e,label:e,children:[]},o=(0,kt.Z)(t,"name");Object.keys(o).forEach(function(s){var l=o[s],h={value:s,label:s,children:[]};l.forEach(function(d){h.children.push({value:d.version,label:d.version,component:d,children:[]})}),i.children.push(h)}),r.push(i)}),r},ua=la(St.$9),ca=function(a){var r=ae()(a,3),n=r[0],e=r[1],t=r[2],i=St.$9.find(function(o){return o.domain===n&&o.name===e&&o.version===t});return i},da=function(a){return[a.domain,a.name,a.version]},pa=function(a){var r=a.component,n=a.onComponentChange;return(0,p.jsx)(Ge.Z,{popupClassName:"component-cascader",size:"small",options:ua,value:r?[r.domain,r.name,r.version]:[],onChange:function(t,i){var o,s=i==null||(o=i[i.length-1])===null||o===void 0?void 0:o.component;s&&n&&n(s)},placeholder:"Please select a component first."})},Tt=(0,I.forwardRef)(function(u,a){var r=u.component,n=u.onComponentChange,e=u.defaultComponentConfig,t=u.onComponentConfigChange,i=u.outputs,o=u.loading,s=(0,I.useMemo)(function(){var h=[];return i.forEach(function(d){d.output_type==="stream"?d.text&&h.push(d.text):d.output_type==="error"&&d.traceback&&h.push(d.traceback.join(""))}),(0,p.jsx)(ea.default,{code:h,theme:"light"})},[i]),l=[{key:"1",label:"Log",children:(0,p.jsx)("div",{className:"sf-component-log",children:o?(0,p.jsx)("div",{className:"loading",children:(0,p.jsx)(j.Z,{})}):s})},{key:"2",label:"Report",children:(0,p.jsx)("div",{className:"sf-component-report",children:(0,p.jsx)(k.Z,{image:k.Z.PRESENTED_IMAGE_SIMPLE,description:"No report."})})}];return(0,p.jsxs)("div",{className:"component-cell-container",children:[(0,p.jsxs)("div",{className:"header",children:[(0,p.jsx)("span",{children:"component:"}),(0,p.jsx)(pa,{component:r,onComponentChange:function(d){n&&n(d)}})]}),(0,p.jsxs)("div",{className:"body",children:[(0,p.jsx)("div",{className:"config",children:r?(0,p.jsx)(Ct,{config:r,ref:a,defaultValue:e,onValuesChange:t}):(0,p.jsx)(k.Z,{image:k.Z.PRESENTED_IMAGE_SIMPLE,description:"Select a component first.",style:{marginTop:120}})}),(0,p.jsx)("div",{className:"result",children:(0,p.jsx)(z.Z,{defaultActiveKey:"1",items:l,size:"small"})})]})]})});Tt.displayName="CellComponent";var Ot,Bt,It,At,Nt,Mt,Et,jt,xt,Vt,Ft,_t,Rt,Pt,ee,xe,Lt,Kt,zt,Dt,Zt=(0,I.forwardRef)(function(u,a){var r=(0,M.oC)(he.yd);return(0,p.jsx)("div",{tabIndex:10,ref:a,className:"sf-component-container",onFocus:function(){r.focus(!0)},onBlur:function(e){var t;typeof a!="function"&&!(a!=null&&(t=a.current)!==null&&t!==void 0&&t.contains(e.relatedTarget))&&r.blur()},children:(0,p.jsx)(Tt,{loading:r.launching,outputs:r.cellModel.outputs,component:r.component,onComponentChange:function(e){r.onComponentChange(e)},defaultComponentConfig:r.defaultComponentConfig,onComponentConfigChange:function(e,t){r.onComponentConfigChange(t)}})})});Zt.displayName="SFComponentCellComponent";var Gt=(Ot=(0,B.H3)(),Bt=(0,ge.ei)("sf-component-cell-view"),It=function(a,r){return(0,B.f3)(he.Hj)(a,void 0,0)},At=function(a,r){return(0,B.f3)(v.xxA)(a,void 0,1)},Nt=function(a,r){return(0,B.f3)(ye.H)(a,void 0,2)},Mt=Reflect.metadata("design:type",Function),Et=Reflect.metadata("design:paramtypes",[typeof CellViewOptions=="undefined"?Object:CellViewOptions,typeof v.xxA=="undefined"?Object:v.xxA,typeof ye.H=="undefined"?Object:ye.H]),jt=(0,M.vg)(),xt=Reflect.metadata("design:type",typeof ComponentSpec=="undefined"?Object:ComponentSpec),Vt=(0,M.vg)(),Ft=Reflect.metadata("design:type",typeof Value=="undefined"?Object:Value),_t=(0,M.vg)(),Rt=Reflect.metadata("design:type",typeof Value=="undefined"?Object:Value),Pt=(0,M.vg)(),Ot(ee=Bt(ee=It(ee=At(ee=Nt(ee=Mt(ee=Et(ee=(xe=function(u){ue()(r,u);var a=ce()(r);function r(n,e,t){var i;return W()(this,r),i=a.call(this,n,e),T()(C()(i),"view",Zt),T()(C()(i),"commandRegistry",void 0),T()(C()(i),"outputArea",{outputs:[]}),G()(C()(i),"component",Lt,C()(i)),G()(C()(i),"componentConfigValue",Kt,C()(i)),G()(C()(i),"defaultComponentConfig",zt,C()(i)),G()(C()(i),"launching",Dt,C()(i)),T()(C()(i),"onComponentChange",function(o){i.component=o,i.componentConfigValue={},i.cellModel.outputs=[],i.cellModel.metadata.component={id:da(o),params:{}},i.cellModel.outputs=[]}),T()(C()(i),"onComponentConfigChange",function(o){i.componentConfigValue=o;var s=i.cellModel.metadata;s&&s.component&&(s.component.params=o),i.save()}),i.commandRegistry=t,i}return X()(r,[{key:"cellModel",get:function(){return this.model}},{key:"onViewMount",value:function(){var e=this.cellModel.metadata;if(e.component){var t=e.component,i=t.id,o=t.params;this.component=ca(i),this.defaultComponentConfig=o,this.componentConfigValue=o}}},{key:"save",value:function(){this.commandRegistry.executeCommand(v.Xa6.Save.id)}},{key:"run",value:function(){var n=S()(f()().mark(function t(){var i=this,o,s,l,h,d,y,g,w,b;return f()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(o=this.getKernelConnections(),o.length!==0){m.next=3;break}return m.abrupt("return",!1);case 3:if(!(!this.component||!this.componentConfigValue)){m.next=6;break}return F.ZP.error(A.U6.t("Please select a component first.")),m.abrupt("return",!1);case 6:for(this.clearExecution(),this.cellModel.outputs=[],m.prev=8,this.cellModel.executing=!0,this.launching=!0,s=[],l=0,h=o.length;l<h;l+=1)d=o[l],y=d.requestExecute({code:wt(this.component,this.componentConfigValue)}),y.onIOPub=function(O){i.handleMessages(O),O.header.msg_type==="execute_input"&&(i.cellModel.kernelExecuting=!0)},y.onReply=function(O){i.handleMessages(O)},s.push(y.done);return m.next=15,Promise.all(s);case 15:if(g=m.sent,this.cellModel.kernelExecuting=!1,this.cellModel.executing=!1,w=g.every(function(O){return O.content.status==="ok"}),!w){m.next=24;break}return this.save(),m.abrupt("return",!0);case 24:if(b=g.find(function(O){return O.content.status!=="ok"}),!b){m.next=27;break}throw new v.e__(b.content);case 27:return m.abrupt("return",!1);case 28:m.next=35;break;case 30:if(m.prev=30,m.t0=m.catch(8),!(m.t0 instanceof Error&&m.t0.message.startsWith("Canceled"))){m.next=34;break}return m.abrupt("return",!1);case 34:throw m.t0;case 35:return m.prev=35,this.launching=!1,m.finish(35);case 38:case"end":return m.stop()}},t,this,[[8,30,35,38]])}));function e(){return n.apply(this,arguments)}return e}()},{key:"getKernelConnections",value:function(){var e=this.parent.model;return e?(0,M.P$)(e.kernelConnections):[]}},{key:"handleMessages",value:function(e){if(this.launching=!1,(0,v.HXF)(e)||(0,v.aL4)(e)){var t=P()(P()({},e.content),{},{output_type:e.header.msg_type});this.cellModel.outputs=[].concat(_e()(this.cellModel.outputs),[t])}}},{key:"toJSON",value:function(){var e=this.component&&this.componentConfigValue?wt(this.component,this.componentConfigValue):"";return{id:this.cellModel.id,cell_type:"component",source:e,metadata:this.cellModel.metadata,outputs:this.cellModel.outputs}}},{key:"focus",value:function(e){e&&(this.cellModel.isEdit=!0)}},{key:"blur",value:function(){this.cellModel.isEdit=!1}},{key:"shouldEnterEditorMode",value:function(){return this.cellModel.isEdit}}]),r}(v.XCr),Lt=N()(xe.prototype,"component",[jt,xt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt=N()(xe.prototype,"componentConfigValue",[Vt,Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt=N()(xe.prototype,"defaultComponentConfig",[_t,Rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dt=N()(xe.prototype,"launching",[Pt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xe))||ee)||ee)||ee)||ee)||ee)||ee)||ee),$t,Ut,Ht,Wt,Te,fa=($t=(0,B.ri)({contrib:[v.SqL,v.GDy]}),Ut=function(a,r){return(0,B.f3)(je)(a,void 0,0)},Ht=Reflect.metadata("design:type",Function),Wt=Reflect.metadata("design:paramtypes",[typeof je=="undefined"?Object:je]),$t(Te=Ut(Te=Ht(Te=Wt(Te=function(){function u(a){W()(this,u),T()(this,"modelFactory",void 0),T()(this,"cellMeta",{type:"component",name:"Component",order:"c",nbformatType:"raw"}),T()(this,"view",Gt),this.modelFactory=a}return X()(u,[{key:"canHandle",value:function(r,n){return n===this.cellMeta.type?1e3:-1}},{key:"createModel",value:function(){var a=S()(f()().mark(function n(e){var t;return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.modelFactory(e),o.abrupt("return",t);case 2:case"end":return o.stop()}},n,this)}));function r(n){return a.apply(this,arguments)}return r}()}]),u}())||Te)||Te)||Te)||Te),ma=c(79239),Xt,Jt,Yt,Qt,qt,en,tn,nn,rn,an,sn,on,ln,un,cn,Oe,Be,dn,pn,fn,mn,vn,hn,gn=(Xt=(0,B.H3)(),Jt=function(a,r){return(0,B.f3)(v.seq)(a,void 0,0)},Yt=Reflect.metadata("design:type",Function),Qt=Reflect.metadata("design:paramtypes",[typeof v.seq=="undefined"?Object:v.seq]),qt=(0,M.vg)(),en=(0,M.vg)(),tn=Reflect.metadata("design:type",Boolean),nn=(0,M.vg)(),rn=Reflect.metadata("design:type",Boolean),an=(0,M.vg)(),sn=Reflect.metadata("design:type",typeof ExecutionCount=="undefined"?Object:ExecutionCount),on=(0,M.vg)(),ln=Reflect.metadata("design:type",typeof Partial=="undefined"?Object:Partial),un=(0,M.vg)(),cn=Reflect.metadata("design:type",Array),Xt(Oe=Jt(Oe=Yt(Oe=Qt(Oe=(Be=function(u){ue()(r,u);var a=ce()(r);function r(n){var e;return W()(this,r),e=a.call(this,n),T()(C()(e),"mimeType","application/vnd.libro.component+json"),T()(C()(e),"hasOutputHidden",!1),T()(C()(e),"hasOutputsScrolled",!1),G()(C()(e),"isEdit",dn,C()(e)),G()(C()(e),"executing",pn,C()(e)),G()(C()(e),"kernelExecuting",fn,C()(e)),G()(C()(e),"executeCount",mn,C()(e)),T()(C()(e),"msgChangeEmitter",void 0),G()(C()(e),"metadata",vn,C()(e)),G()(C()(e),"outputs",hn,C()(e)),e.executing=!1,e.kernelExecuting=!1,e.msgChangeEmitter=new ma.Q5,e.metadata=n.cell.metadata||{},e.outputs=n.cell.outputs||[],e.value=(0,v.XaW)(n.cell.source),e}return X()(r,[{key:"msgChange",get:function(){return this.msgChangeEmitter.event}},{key:"clearExecution",value:function(){this.metadata={},this.outputs=[],this.executing=!1,this.kernelExecuting=!1,this.executeCount=null}}]),r}(v.KZ9),dn=N()(Be.prototype,"isEdit",[qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),pn=N()(Be.prototype,"executing",[en,tn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fn=N()(Be.prototype,"kernelExecuting",[nn,rn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mn=N()(Be.prototype,"executeCount",[an,sn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vn=N()(Be.prototype,"metadata",[on,ln],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hn=N()(Be.prototype,"outputs",[un,cn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Be))||Oe)||Oe)||Oe)||Oe),va=we.R.create().register(fa,Gt,gn,{token:je,useFactory:function(a){return function(r){var n=a.container.createChild();n.register({token:v.seq,useValue:r});var e=n.get(gn);return e}}}),$e=c(72085),ha=c(7146),ft=c(73997),H=c(86038),yn,bn,Cn,wn,kn,Sn,Tn,On,J,re=(yn=(0,B.ri)(),bn=function(a,r){return(0,B.f3)(v.oeX)(a,void 0,0)},Cn=function(a,r){return(0,B.f3)(v.frY)(a,void 0,1)},wn=function(a,r){return(0,B.f3)(H.CP)(a,void 0,2)},kn=function(a,r){return(0,B.f3)(v.pv1)(a,void 0,3)},Sn=function(a,r){return(0,B.f3)(ft.V)(a,void 0,4)},Tn=Reflect.metadata("design:type",Function),On=Reflect.metadata("design:paramtypes",[typeof v.oeX=="undefined"?Object:v.oeX,typeof v.frY=="undefined"?Object:v.frY,typeof H.CP=="undefined"?Object:H.CP,typeof v.pv1=="undefined"?Object:v.pv1,typeof ft.V=="undefined"?Object:ft.V]),yn(J=bn(J=Cn(J=wn(J=kn(J=Sn(J=Tn(J=On(J=function(){function u(a,r,n,e,t){W()(this,u),T()(this,"file2KernelConnections",new Map),T()(this,"kernelConnection2Server",new Map),T()(this,"sessionRestAPI",void 0),T()(this,"kernelRestAPI",void 0),T()(this,"kernelConnectionFactory",void 0),T()(this,"serverManager",void 0),T()(this,"storageService",void 0),this.sessionRestAPI=a,this.kernelRestAPI=r,this.kernelConnectionFactory=e,this.serverManager=n,this.storageService=t}return X()(u,[{key:"createKernelConnections",value:function(){var a=S()(f()().mark(function n(e){var t=this,i,o,s,l,h,d;return f()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.serverManager.getServerList();case 2:return i=g.sent.filter(function(w){return w.status==="running"}),o=[],g.next=6,this.storageService.getData(this.storedKey(e),[]);case 6:s=g.sent,l=f()().mark(function w(){var b,E,m,O,Z,x;return f()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(b=i[h],E=s.find(function(_){return _.serverId===b.id}),!E){K.next=21;break}return O=E.options,Z=O.model.id,K.next=7,t.isKernelAlive(Z,b);case 7:if(x=K.sent,!x){K.next=14;break}return K.next=11,t.connectToKernel(P()(P()({},O),{},{serverSettings:t.serverManager.getServerUrl(b)}));case 11:m=K.sent,K.next=19;break;case 14:return K.next=16,t.removeStoredSession(e,E);case 16:return K.next=18,t.createKernelConnection(e,b);case 18:m=K.sent;case 19:K.next=24;break;case 21:return K.next=23,t.createKernelConnection(e,b);case 23:m=K.sent;case 24:m&&(o.push(m),t.kernelConnection2Server.set(m.id,b.id));case 25:case"end":return K.stop()}},w)}),h=0,d=i.length;case 9:if(!(h<d)){g.next=14;break}return g.delegateYield(l(),"t0",11);case 11:h++,g.next=9;break;case 14:return this.file2KernelConnections.set(this.storedKey(e),o),g.abrupt("return",o);case 16:case"end":return g.stop()}},n,this)}));function r(n){return a.apply(this,arguments)}return r}()},{key:"addKernelConnectionOnServer",value:function(){var a=S()(f()().mark(function n(e,t){var i,o;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.createKernelConnection(e,t);case 2:i=l.sent,i&&(this.kernelConnection2Server.set(i.id,t.id),o=this.file2KernelConnections.get(this.storedKey(e))||[],this.file2KernelConnections.set(this.storedKey(e),[].concat(_e()(o),[i])));case 4:case"end":return l.stop()}},n,this)}));function r(n,e){return a.apply(this,arguments)}return r}()},{key:"deleteKernelConnectionOnServer",value:function(){var a=S()(f()().mark(function n(e,t){var i=this,o,s,l,h,d;return f()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.storageService.getData(this.storedKey(e),[]);case 2:if(o=g.sent,s=o.find(function(w){return w.serverId===t.id}),!s){g.next=7;break}return g.next=7,this.removeStoredSession(e,s);case 7:l=this.file2KernelConnections.get(this.storedKey(e)),l&&(h=[],l.forEach(function(w){var b=i.getServerByKernelConnection(w);b&&b.id===t.id&&(i.kernelConnection2Server.delete(w.id),w.shutdown(),h.push(w.id))}),d=l.filter(function(w){return!h.includes(w.id)}),this.file2KernelConnections.set(this.storedKey(e),d));case 9:case"end":return g.stop()}},n,this)}));function r(n,e){return a.apply(this,arguments)}return r}()},{key:"shutdownKernelConnections",value:function(){var a=S()(f()().mark(function n(e){var t=this,i;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(i=this.file2KernelConnections.get(this.storedKey(e)),!i){s.next=6;break}return i.forEach(function(l){t.kernelConnection2Server.delete(l.id),l.shutdown()}),s.next=5,this.clearStoredSessions(e);case 5:this.file2KernelConnections.delete(this.storedKey(e));case 6:case"end":return s.stop()}},n,this)}));function r(n){return a.apply(this,arguments)}return r}()},{key:"getKernelConnections",value:function(r){return this.file2KernelConnections.get(this.storedKey(r))||[]}},{key:"getServerByKernelConnection",value:function(r){var n=this.kernelConnection2Server.get(r.id);if(n)return this.serverManager.servers.find(function(e){return e.id===n})}},{key:"createKernelConnection",value:function(){var a=S()(f()().mark(function n(e,t){var i,o,s,l;return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=this.getDefaultKernelName(e,t),d.next=3,this.sessionRestAPI.startSession({name:e.name,kernel:{kernelName:i},path:e.path,type:e.type},this.serverManager.getServerUrl(t));case 3:if(o=d.sent,!(!o||!o.kernel)){d.next=6;break}return d.abrupt("return");case 6:return s={model:{id:o.kernel.id,name:o.kernel.name}},d.next=9,this.addStoredSession(e,{sessionId:o.id,serverId:t.id,options:s});case 9:return d.next=11,this.connectToKernel(P()(P()({},s),{},{serverSettings:this.serverManager.getServerUrl(t)}));case 11:return l=d.sent,d.abrupt("return",l);case 13:case"end":return d.stop()}},n,this)}));function r(n,e){return a.apply(this,arguments)}return r}()},{key:"connectToKernel",value:function(){var a=S()(f()().mark(function n(e){var t;return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.kernelConnectionFactory(e),o.abrupt("return",t);case 2:case"end":return o.stop()}},n,this)}));function r(n){return a.apply(this,arguments)}return r}()},{key:"isKernelAlive",value:function(){var a=S()(f()().mark(function n(e,t){var i;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,this.kernelRestAPI.getKernelModel(e,this.serverManager.getServerUrl(t));case 3:return i=s.sent,s.abrupt("return",!!i);case 7:return s.prev=7,s.t0=s.catch(0),s.abrupt("return",!1);case 10:case"end":return s.stop()}},n,this,[[0,7]])}));function r(n,e){return a.apply(this,arguments)}return r}()},{key:"storedKey",value:function(r){return"secretnote_".concat(r.path,"_").concat(r.name)}},{key:"addStoredSession",value:function(){var a=S()(f()().mark(function n(e,t){var i;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.storageService.getData(this.storedKey(e));case 2:return i=s.sent,i?i.push(t):i=[t],s.next=6,this.storageService.setData(this.storedKey(e),i);case 6:case"end":return s.stop()}},n,this)}));function r(n,e){return a.apply(this,arguments)}return r}()},{key:"removeStoredSession",value:function(){var a=S()(f()().mark(function n(e,t){var i;return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.storageService.getData(this.storedKey(e),[]);case 2:return i=s.sent,i=i.filter(function(l){return l.sessionId!==t.sessionId}),s.next=6,this.storageService.setData(this.storedKey(e),i);case 6:case"end":return s.stop()}},n,this)}));function r(n,e){return a.apply(this,arguments)}return r}()},{key:"clearStoredSessions",value:function(){var a=S()(f()().mark(function n(e){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.storageService.setData(this.storedKey(e),void 0);case 2:case"end":return i.stop()}},n,this)}));function r(n){return a.apply(this,arguments)}return r}()},{key:"getDefaultKernelName",value:function(r,n){var e,t,i=((e=r.content.metadata.kernelspec)===null||e===void 0?void 0:e.name)||((t=n.kernelspec)===null||t===void 0?void 0:t.default)||"python3";return i}}]),u}())||J)||J)||J)||J)||J)||J)||J)||J),ga=we.R.create().register(re),Bn,In,An,Nn,Mn,En,jn,xn,Vn,Fn,_n,Rn,Pn,Y,Ve,Ln,Kn,zn,Dn,ya=(Bn=(0,B.H3)(),In=function(a,r){return(0,B.f3)(re)(a,void 0,0)},An=function(a,r){return(0,B.f3)(H.CP)(a,void 0,1)},Nn=function(a,r){return(0,B.f3)(v.QY6)(a,void 0,2)},Mn=function(a,r){return(0,B.f3)($e.Z)(a,void 0,3)},En=function(a,r){return(0,B.f3)(ye.H)(a,void 0,4)},jn=Reflect.metadata("design:type",Function),xn=Reflect.metadata("design:paramtypes",[typeof re=="undefined"?Object:re,typeof H.CP=="undefined"?Object:H.CP,typeof v.QY6=="undefined"?Object:v.QY6,typeof $e.Z=="undefined"?Object:$e.Z,typeof ye.H=="undefined"?Object:ye.H]),Vn=(0,M.vg)(),Fn=(0,M.vg)(),_n=Reflect.metadata("design:type",Array),Rn=(0,M.vg)(),Pn=(0,M.vg)(),Bn(Y=In(Y=An(Y=Nn(Y=Mn(Y=En(Y=jn(Y=xn(Y=(Ve=function(u){ue()(r,u);var a=ce()(r);function r(n,e,t,i,o){var s;return W()(this,r),s=a.call(this),T()(C()(s),"kernelManager",void 0),T()(C()(s),"serverManager",void 0),T()(C()(s),"modalService",void 0),T()(C()(s),"commandRegistry",void 0),T()(C()(s),"currentFileContents",void 0),T()(C()(s),"contentsManager",void 0),G()(C()(s),"kernelConnecting",Ln,C()(s)),G()(C()(s),"kernelConnections",Kn,C()(s)),G()(C()(s),"filePath",zn,C()(s)),G()(C()(s),"lspEnabled",Dn,C()(s)),T()(C()(s),"autoSave",(0,ha.Z)(function(){s.commandRegistry.executeCommand(v.Xa6.Save.id)},500)),s.kernelManager=n,s.serverManager=e,s.contentsManager=t,s.modalService=i,s.commandRegistry=o,s.serverManager.onServerAdded(s.onServerAdded.bind(C()(s))),s.serverManager.onServerDeleted(s.onServerDeleted.bind(C()(s))),s.onSourceChanged(s.autoSave.bind(C()(s))),s}return X()(r,[{key:"isKernelIdle",get:function(){return this.kernelConnections.every(function(e){return e.status==="idle"})}},{key:"kernelConnection",get:function(){return this.kernelConnections[0]}},{key:"startKernelConnection",value:function(){var n=S()(f()().mark(function t(){var i,o;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.kernelConnecting=!0,i=this.currentFileContents,i){l.next=4;break}return l.abrupt("return");case 4:if(o=this.kernelManager.getKernelConnections(i),!(o.length>0)){l.next=10;break}this.kernelConnections=o,this.kernelConnecting=!1,l.next=14;break;case 10:return l.next=12,this.kernelManager.createKernelConnections(i);case 12:this.kernelConnections=l.sent,this.kernelConnecting=!1;case 14:case"end":return l.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"saveNotebookContent",value:function(){var n=S()(f()().mark(function t(){var i,o,s,l;return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(i=this.toJSON(),this.currentFileContents){d.next=3;break}throw new Error("currentFileContents is undefined");case 3:return d.prev=3,d.next=6,this.contentsManager.save(this.currentFileContents.path,{type:this.currentFileContents.type,content:i,format:this.currentFileContents.format});case 6:if(o=d.sent,o){d.next=9;break}return d.abrupt("return");case 9:if(!(o.last_modified===this.currentFileContents.last_modified||o.size===0)){d.next=13;break}throw l="File Save Error: ".concat((s=o)===null||s===void 0?void 0:s.message),this.modalService.openModal(v.l6J),new Error(l);case 13:d.next=21;break;case 15:if(d.prev=15,d.t0=d.catch(3),o){d.next=19;break}return d.abrupt("return");case 19:throw this.modalService.openModal(v.l6J),new Error("File Save Error");case 21:return d.next=23,this.createCheckpoint();case 23:case"end":return d.stop()}},t,this,[[3,15]])}));function e(){return n.apply(this,arguments)}return e}()},{key:"onServerAdded",value:function(){var n=S()(f()().mark(function t(i){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.currentFileContents){s.next=6;break}return s.next=3,this.kernelManager.addKernelConnectionOnServer(this.currentFileContents,i);case 3:return s.next=5,this.kernelManager.createKernelConnections(this.currentFileContents);case 5:this.kernelConnections=s.sent;case 6:case"end":return s.stop()}},t,this)}));function e(t){return n.apply(this,arguments)}return e}()},{key:"onServerDeleted",value:function(){var n=S()(f()().mark(function t(i){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.currentFileContents){s.next=6;break}return s.next=3,this.kernelManager.deleteKernelConnectionOnServer(this.currentFileContents,i);case 3:return s.next=5,this.kernelManager.createKernelConnections(this.currentFileContents);case 5:this.kernelConnections=s.sent;case 6:case"end":return s.stop()}},t,this)}));function e(t){return n.apply(this,arguments)}return e}()},{key:"canRun",value:function(){return!0}},{key:"interrupt",value:function(){var n=S()(f()().mark(function t(){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Promise.all(this.kernelConnections.map(function(){var s=S()(f()().mark(function l(h){return f()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,h.interrupt();case 2:case"end":return y.stop()}},l)}));return function(l){return s.apply(this,arguments)}}()));case 2:case"end":return o.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"shutdown",value:function(){var n=S()(f()().mark(function t(){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.currentFileContents){o.next=4;break}return o.next=3,this.kernelManager.shutdownKernelConnections(this.currentFileContents);case 3:this.kernelConnections=[];case 4:case"end":return o.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"restart",value:function(){var n=S()(f()().mark(function t(){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.kernelConnections.length!==0){o.next=5;break}return o.next=3,this.startKernelConnection();case 3:o.next=7;break;case 5:return o.next=7,Promise.all(this.kernelConnections.map(function(){var s=S()(f()().mark(function l(h){return f()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,h.restart();case 2:case"end":return y.stop()}},l)}));return function(l){return s.apply(this,arguments)}}()));case 7:case"end":return o.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"reconnect",value:function(){var n=S()(f()().mark(function t(){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Promise.all(this.kernelConnections.map(function(){var s=S()(f()().mark(function l(h){return f()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,h.reconnect();case 2:case"end":return y.stop()}},l)}));return function(l){return s.apply(this,arguments)}}()));case 2:case"end":return o.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"findRunningCell",value:function(){var e=this.cells.findIndex(function(t){return v.lPh.is(t.model)?t.model.kernelExecuting===!0:!1});e>-1&&(this.selectCell(this.cells[e]),this.scrollToView(this.cells[e]))}},{key:"createCheckpoint",value:function(){var n=S()(f()().mark(function t(){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.currentFileContents){o.next=3;break}return o.next=3,this.contentsManager.createCheckpoint(this.currentFileContents.path);case 3:case"end":return o.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"listCheckpoints",value:function(){var n=S()(f()().mark(function t(){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.currentFileContents){o.next=3;break}return o.next=3,this.contentsManager.listCheckpoints(this.currentFileContents.path);case 3:case"end":return o.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"restoreCheckpoint",value:function(){var n=S()(f()().mark(function t(i){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.currentFileContents){s.next=3;break}return s.next=3,this.contentsManager.restoreCheckpoint(this.currentFileContents.path,i);case 3:case"end":return s.stop()}},t,this)}));function e(t){return n.apply(this,arguments)}return e}()},{key:"deleteCheckpoint",value:function(){var n=S()(f()().mark(function t(i){return f()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this.currentFileContents){s.next=3;break}return s.next=3,this.contentsManager.deleteCheckpoint(this.currentFileContents.path,i);case 3:case"end":return s.stop()}},t,this)}));function e(t){return n.apply(this,arguments)}return e}()}]),r}(v.ero),Ln=N()(Ve.prototype,"kernelConnecting",[Vn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Kn=N()(Ve.prototype,"kernelConnections",[Fn,_n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),zn=N()(Ve.prototype,"filePath",[Rn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Dn=N()(Ve.prototype,"lspEnabled",[Pn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ve))||Y)||Y)||Y)||Y)||Y)||Y)||Y)||Y),Zn,Gn,ba=(Zn=(0,B.H3)(),Zn(Gn=function(u){ue()(r,u);var a=ce()(r);function r(){return W()(this,r),a.apply(this,arguments)}return X()(r)}(v.u_T))||Gn),mt=c(7317),Le=c(80155),Ca=c(42480),Ue=c(39270),$n=c(44549),wa=Ca.Z.CheckableTag;function ka(u){var a=u.items,r=u.value,n=u.onChange,e=function(o,s){var l=s?[].concat(_e()(r),[o]):r.filter(function(h){return h!==o});n&&n(l)},t=function(o){var s=a.filter(function(l){return o.includes(l.key)});return s.length===0?"Select Nodes":s.map(function(l){return l.label}).join(",")};return(0,p.jsx)(Ue.Z.Ribbon,{text:(0,p.jsx)(Ee.Z,{placement:"bottomRight",trigger:["click"],overlayStyle:{paddingTop:0},overlayClassName:"secretnote-ribbon-popover",content:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"title",children:[A.U6.t("\u4E0B\u9762\u662F\u5C06\u8981\u6267\u884C\u8BE5\u4EE3\u7801\u7684\u8282\u70B9\u5217\u8868"),":"]}),(0,p.jsx)($n.Z,{size:[0,8],wrap:!0,children:a.map(function(i){return(0,p.jsx)(wa,{checked:r.includes(i.key),onChange:function(s){return e(i.key,s)},children:i.label},i.key)})})]}),children:(0,p.jsx)("span",{className:"secretnote-ribbon",children:t(r)})}),children:u.children})}var Un,Hn,Wn,Xn,Jn,Yn,Qn,qn,er,tr,nr,rr,D,vt,ar,ir=(0,I.forwardRef)(function(u,a){var r=(0,M.oC)(he.yd),n=r.partyList,e=r.parties;return(0,p.jsx)("div",{className:r.className,ref:a,tabIndex:10,onBlur:r.blur,children:(0,p.jsx)(ka,{items:n.map(function(t){return{label:t,key:t}}),value:e,onChange:function(i){r.onPartiesChange(i)},children:(0,p.jsx)(v.sUT,{})})})});ir.displayName="SecretNoteCodeCellComponent";var ht=[],Sa=(Un=(0,B.H3)(),Hn=(0,ge.ei)("secretnote-code-cell-view"),Wn=function(a,r){return(0,B.f3)(he.Hj)(a,void 0,0)},Xn=function(a,r){return(0,B.f3)(v.xxA)(a,void 0,1)},Jn=function(a,r){return(0,B.f3)(mt.v)(a,void 0,2)},Yn=function(a,r){return(0,B.f3)(v.fv2)(a,void 0,3)},Qn=function(a,r){return(0,B.f3)(H.CP)(a,void 0,4)},qn=function(a,r){return(0,B.f3)(re)(a,void 0,5)},er=Reflect.metadata("design:type",Function),tr=Reflect.metadata("design:paramtypes",[typeof CellViewOptions=="undefined"?Object:CellViewOptions,typeof v.xxA=="undefined"?Object:v.xxA,typeof mt.v=="undefined"?Object:mt.v,typeof v.fv2=="undefined"?Object:v.fv2,typeof H.CP=="undefined"?Object:H.CP,typeof re=="undefined"?Object:re]),nr=(0,M.vg)(),rr=Reflect.metadata("design:type",Array),Un(D=Hn(D=Wn(D=Xn(D=Jn(D=Yn(D=Qn(D=qn(D=er(D=tr(D=(vt=function(u){ue()(r,u);var a=ce()(r);function r(n,e,t,i,o,s){var l;return W()(this,r),l=a.call(this,n,e,t,i),T()(C()(l),"serverManager",void 0),T()(C()(l),"kernelManager",void 0),T()(C()(l),"view",ir),G()(C()(l),"parties",ar,C()(l)),l.serverManager=o,l.kernelManager=s,l.parties=l.getInitializedParties(),l}return X()(r,[{key:"partyList",get:function(){return this.serverManager.servers.map(function(e){return e.name})}},{key:"getUsableConnections",value:function(){var e=this,t=this.parent.model;if(!t)return[];var i=(0,M.P$)(t.kernelConnections);return i.filter(function(o){if(o.isDisposed)return!1;var s=e.kernelManager.getServerByKernelConnection(o);return s&&s.status==="running"&&e.parties.includes(s.name)})}},{key:"run",value:function(){var n=S()(f()().mark(function t(){var i=this,o,s,l,h,d,y,g,w,b;return f()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(o=this.model,s=this.getUsableConnections(),s.length!==0){m.next=5;break}return F.ZP.info(A.U6.t("No available node to execute")),m.abrupt("return",!1);case 5:this.clearExecution(),this.updateExecutionStatus({executing:!0}),this.updateExecutionTime({toExecute:new Date().toISOString()}),this.savePartiesToMeta(),m.prev=9,l=[],h=f()().mark(function O(){var Z,x;return f()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:Z=s[d],x=Z.requestExecute({code:o.value},!1),x.onIOPub=function(_){_.header.msg_type==="execute_input"&&(i.updateExecutionStatus({kernelExecuting:!0}),i.updateExecutionTime({start:_.header.date})),o.msgChangeEmitter.fire({connection:Z,msg:_})},x.onReply=function(_){o.msgChangeEmitter.fire({connection:Z,msg:_})},l.push(x.done);case 5:case"end":return K.stop()}},O)}),d=0,y=s.length;case 13:if(!(d<y)){m.next=18;break}return m.delegateYield(h(),"t0",15);case 15:d+=1,m.next=13;break;case 18:return m.next=20,Promise.all(l);case 20:if(g=m.sent,this.updateExecutionStatus({executing:!1,kernelExecuting:!1}),this.updateExecutionTime(this.parseMessageTime(g)),w=g.every(function(O){return O.content.status==="ok"}),!w){m.next=28;break}return m.abrupt("return",!0);case 28:if(b=g.find(function(O){return O.content.status!=="ok"}),!b){m.next=31;break}throw new v.e__(b.content);case 31:return m.abrupt("return",!1);case 32:m.next=39;break;case 34:if(m.prev=34,m.t1=m.catch(9),!(m.t1 instanceof Error&&m.t1.message.startsWith("Canceled"))){m.next=38;break}return m.abrupt("return",!1);case 38:throw m.t1;case 39:case"end":return m.stop()}},t,this,[[9,34]])}));function e(){return n.apply(this,arguments)}return e}()},{key:"updateExecutionStatus",value:function(e){var t=e.executing,i=e.kernelExecuting;(0,Le.Z)(t)||(this.model.executing=t),(0,Le.Z)(i)||(this.model.kernelExecuting=i)}},{key:"updateExecutionTime",value:function(e){var t=this.model.metadata.execution;if(t){var i=e.start,o=e.end,s=e.toExecute;(0,Le.Z)(i)||(t["shell.execute_reply.started"]=i),(0,Le.Z)(o)||(t["shell.execute_reply.end"]=o),(0,Le.Z)(s)||(t.to_execute=s)}}},{key:"parseMessageTime",value:function(e){var t="",i="";return e.forEach(function(o){var s=o.metadata.started,l=o.header.date;(t===""||(0,me.Id)(s,t)<0)&&(t=s),(i===""||(0,me.Id)(l,i)>0)&&(i=l)}),{start:t,end:i}}},{key:"onPartiesChange",value:function(e){this.parties=e,this.savePartiesToMeta(e),ht=e}},{key:"getInitializedParties",value:function(){var e=this,t=this.model.metadata.execution;if(t&&t.parties)try{var i=JSON.parse(t.parties);return i.filter(function(o){return e.partyList.includes(o)})}catch(o){return[]}else if(ht.length>0)return ht;return this.partyList}},{key:"savePartiesToMeta",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.parties,t=this.model.metadata.execution;t&&(t.parties=JSON.stringify(e))}}]),r}(v.qmq),ar=N()(vt.prototype,"parties",[nr,rr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),vt))||D)||D)||D)||D)||D)||D)||D)||D)||D)||D),Ta=c(74799),sr,or,Oa=(sr=(0,B.ri)({contrib:v.Vij}),sr(or=function(){function u(){W()(this,u),T()(this,"canHandle",function(){return 3})}return X()(u,[{key:"loadContent",value:function(){var a=S()(f()().mark(function n(e,t){var i,o,s,l;return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return i=t,o=new Ta.o(e.resource),s=o.path.toString(),d.next=5,i.contentsManager.get(s);case 5:if(l=d.sent,!l){d.next=12;break}return l.content.nbformat_minor=5,i.currentFileContents=l,i.filePath=l.path,!i.quickEditMode&&!i.readOnly&&i.startKernelConnection(),d.abrupt("return",i.currentFileContents.content);case 12:case"end":return d.stop()}},n)}));function r(n,e){return a.apply(this,arguments)}return r}()}]),u}())||or),Ba=c(78846),Ia=c.n(Ba),Aa=c(54088),Na=c.n(Aa),lr,ur,cr,dr,pr,fr,ie,Ma=(lr=(0,B.H3)(),ur=(0,ge.ei)("libro-output-area"),cr=function(a,r){return(0,B.f3)(he.Hj)(a,void 0,0)},dr=function(a,r){return(0,B.f3)(re)(a,void 0,1)},pr=Reflect.metadata("design:type",Function),fr=Reflect.metadata("design:paramtypes",[typeof IOutputAreaOption=="undefined"?Object:IOutputAreaOption,typeof re=="undefined"?Object:re]),lr(ie=ur(ie=cr(ie=dr(ie=pr(ie=fr(ie=function(u){ue()(r,u);var a=ce()(r);function r(n,e){var t;return W()(this,r),t=a.call(this,n),T()(C()(t),"kernelManager",void 0),T()(C()(t),"connectionId2Message",{}),t.kernelManager=e,t.connectionId2Message={},t.handleMsg(),t}return X()(r,[{key:"handleMsg",value:function(){var e=this,t=this.cell.model;t.msgChangeEmitter.event(function(i){var o=i.connection,s=i.msg;if(s.header.msg_type!=="status"){if(s.header.msg_type==="execute_input"&&(t.executeCount=s.content.execution_count),(0,v.t3d)(s)||(0,v.HXF)(s)||(0,v.aL4)(s)||(0,v.fkE)(s)){var l=P()(P()({},s.content),{},{output_type:s.header.msg_type});e.addOutput(o,l)}if((0,v.vUL)(s)){var h=s.content;if(h.status!=="ok")return;var d=h&&h.payload;if(!d||!d.length)return;var y=d.filter(function(b){return b.source==="page"});if(!y.length)return;var g=JSON.parse(JSON.stringify(y[0])),w={output_type:"display_data",data:g.data,metadata:{}};e.addOutput(o,w)}}})}},{key:"addOutput",value:function(e,t){var i=this.connectionId2Message[e.id]||[];i.length===0&&i.push(this.getBreakOutput(e));var o=i.length-1,s=i[o];if((0,v.eeP)(t)&&(0,v.eeP)(s)&&t.name===s.name){t.text=(0,v.e$h)(s.text+(0,v.Fvn)(t.text)),i[o]=t,this.flushOutputs();return}(0,v.eeP)(t)&&(t.text=(0,v.e$h)((0,v.Fvn)(t.text))),i.push(t),this.connectionId2Message[e.id]=i,this.flushOutputs()}},{key:"flushOutputs",value:function(){var n=S()(f()().mark(function t(){var i=this,o,s;return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o=Object.keys(this.connectionId2Message).length,s=Object.values(this.connectionId2Message).flat(),o<2&&(s=s.filter(function(d){return!d.breakFlag})),this.outputs.forEach(function(d){d.dispose()}),h.next=6,Promise.all(s.map(function(d){return i.doCreateOutput(d)}));case 6:this.outputs=h.sent;case 7:case"end":return h.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"getBreakOutput",value:function(e){var t=this.kernelManager.getServerByKernelConnection(e),i=(t==null?void 0:t.name)||e.clientId,o={output_type:"display_data",data:{"text/html":"<h4>".concat(i,"'s Output:</h4>")},metadata:{},breakFlag:!0};return o}},{key:"clear",value:function(){Ia()(Na()(r.prototype),"clear",this).call(this),this.connectionId2Message={}}}]),r}(v.fZS))||ie)||ie)||ie)||ie)||ie)||ie),Ea=we.R.create().register(Oa,Ma,{token:v.ero,useClass:ya},{token:v.DHb,useClass:ba},{token:v.iKk,useClass:Sa}).dependOn(v.MDs,H.aB,ga),ja=c(52080),mr=c(20904),xa=c(31300),Va=c(22825),Ke=c(40256),vr,hr,gr,yr,br,Cr,wr,kr,Sr,Tr,te,He,Or,Br,Ir=(vr=(0,B.ri)(),hr=function(a,r){return(0,B.f3)(H.CP)(a,void 0,0)},gr=function(a,r){return(0,B.f3)(re)(a,void 0,1)},yr=function(a,r){return(0,B.f3)(v.Ner)(a,void 0,2)},br=function(a,r){return(0,B.f3)(Ke.nR)(a,void 0,3)},Cr=Reflect.metadata("design:type",Function),wr=Reflect.metadata("design:paramtypes",[typeof H.CP=="undefined"?Object:H.CP,typeof re=="undefined"?Object:re,typeof v.Ner=="undefined"?Object:v.Ner,typeof Ke.nR=="undefined"?Object:Ke.nR]),kr=(0,M.vg)(),Sr=Reflect.metadata("design:type",Array),Tr=(0,M.vg)(),vr(te=hr(te=gr(te=yr(te=br(te=Cr(te=wr(te=(He=function(){function u(a,r,n,e){var t=this;W()(this,u),T()(this,"_pollModels",void 0),T()(this,"serverManager",void 0),T()(this,"kernelManager",void 0),T()(this,"serverConnection",void 0),T()(this,"notebookFileService",void 0),G()(this,"metrics",Or,this),G()(this,"enabled",Br,this),this.serverManager=a,this.kernelManager=r,this.serverConnection=n,this.notebookFileService=e,this.notebookFileService.onNotebookFileChanged(function(){t.refresh()}),this._pollModels=new Va.n_({auto:!1,factory:function(){return t.getMetrics()},frequency:{interval:4*1e3,backoff:!0,max:300*1e3},name:"metrics",standby:"when-hidden"})}return X()(u,[{key:"enable",value:function(){var a=S()(f()().mark(function n(){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.enabled=!0,this.getDefaultMetrics(),t.next=4,(0,M.P$)(this._pollModels).start();case 4:return t.next=6,(0,M.P$)(this._pollModels).tick;case 6:case"end":return t.stop()}},n,this)}));function r(){return a.apply(this,arguments)}return r}()},{key:"disable",value:function(){var a=S()(f()().mark(function n(){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.enabled=!1,t.next=3,(0,M.P$)(this._pollModels).stop();case 3:case"end":return t.stop()}},n,this)}));function r(){return a.apply(this,arguments)}return r}()},{key:"refresh",value:function(){var a=S()(f()().mark(function n(){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.enabled){t.next=5;break}return t.next=3,(0,M.P$)(this._pollModels).refresh();case 3:return t.next=5,(0,M.P$)(this._pollModels).tick;case 5:case"end":return t.stop()}},n,this)}));function r(){return a.apply(this,arguments)}return r}()},{key:"getDefaultMetrics",value:function(){var r=this.notebookFileService.currentNotebookFile,n=[];if(r)for(var e=this.kernelManager.getKernelConnections(r),t=0,i=e.length;t<i;t++){var o=e[t],s=o.model,l=o.status,h=s.id,d=s.name,y=v.jro[l],g=y.color,w=y.text_zh,b=this.kernelManager.getServerByKernelConnection(o);b&&n.push({server:b,host:{cpu:0,memory:0,cpuText:"N/A",memoryText:"N/A"},kernel:{id:h,name:d,pid:"",status:l,statusText:w,statusColor:g,cpu:0,memory:0,options:[],cpuText:"N/A",memoryText:"N/A"}})}return this.metrics=n,n}},{key:"getMetrics",value:function(){var a=S()(f()().mark(function n(){var e,t,i,o,s,l;return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(e=this.notebookFileService.currentNotebookFile,t=[],!e){d.next=13;break}i=this.kernelManager.getKernelConnections(e),o=0,s=i.length;case 5:if(!(o<s)){d.next=13;break}return d.next=8,this.getMetricsItem(i[o]);case 8:l=d.sent,l&&t.push(l);case 10:o++,d.next=5;break;case 13:return this.metrics=t,d.abrupt("return",t);case 15:case"end":return d.stop()}},n,this)}));function r(){return a.apply(this,arguments)}return r}()},{key:"getMetricsItem",value:function(){var a=S()(f()().mark(function n(e){var t,i,o;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(t=this.kernelManager.getServerByKernelConnection(e),t){l.next=3;break}return l.abrupt("return");case 3:return l.next=5,this.getServerStatus(t);case 5:return i=l.sent,l.next=8,this.getKernelStatus(t,e);case 8:return o=l.sent,l.abrupt("return",{server:t,host:i,kernel:o});case 10:case"end":return l.stop()}},n,this)}));function r(n){return a.apply(this,arguments)}return r}()},{key:"getServerStatus",value:function(){var a=S()(f()().mark(function n(e){var t,i,o,s;return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.prev=0,t="/api/metrics/v1",i={method:"GET"},o=this.serverManager.getServerUrl(e).baseUrl,h.next=6,(0,me.WY)(t,i,o);case 6:return s=h.sent,h.abrupt("return",{cpu:s.cpu_percent,memory:s.rss,cpuText:"".concat(s.cpu_percent," %"),memoryText:this.humanFileSize(s.rss)});case 10:h.prev=10,h.t0=h.catch(0),console.log(h.t0);case 13:return h.abrupt("return",{cpu:0,memory:0,cpuText:"N/A",memoryText:"N/A"});case 14:case"end":return h.stop()}},n,this,[[0,10]])}));function r(n){return a.apply(this,arguments)}return r}()},{key:"getKernelStatus",value:function(){var a=S()(f()().mark(function n(e,t){var i,o,s,l,h,d,y,g,w,b,E,m,O,Z,x,Ne,K,_;return f()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return i=t.model,o=t.status,s=i.id,l=i.name,h=e.kernelspec?Object.keys(e.kernelspec.kernelspecs):[],se.prev=3,d="/api/metrics/v1/kernel_usage/get_usage/"+s,y={method:"GET"},g=this.serverManager.getServerUrl(e).baseUrl,se.next=9,(0,me.WY)(d,y,g);case 9:return w=se.sent,b=this.parseKernelStatus(w),E=b.cpu,m=b.memory,O=b.pid,Z=b.cpuText,x=b.memoryText,Ne=v.jro[o],K=Ne.color,_=Ne.text_zh,se.abrupt("return",{id:s,name:l,pid:O,status:o,statusText:_,statusColor:K,cpu:E,memory:m,options:h,cpuText:Z,memoryText:x});case 15:se.prev=15,se.t0=se.catch(3),console.log(se.t0);case 18:return se.abrupt("return",{id:s,name:l,pid:"",status:"unknown",statusText:v.jro.unknown.text_zh,statusColor:v.jro.unknown.color,cpu:0,memory:0,options:h,cpuText:"N/A",memoryText:"N/A"});case 19:case"end":return se.stop()}},n,this,[[3,15]])}));function r(n,e){return a.apply(this,arguments)}return r}()},{key:"humanFileSize",value:function(r){var n=Math.floor(Math.log(r)/Math.log(1024));return(r/Math.pow(1024,n)).toFixed(2)+" "+["B","kB","MB","GB","TB"][n]}},{key:"parseKernelStatus",value:function(r){var n=r.content.kernel_cpu,e=r.content.kernel_memory,t=r.content.pid,i="".concat(n," %"),o=this.humanFileSize(e);return{cpu:n,memory:e,pid:t,cpuText:i,memoryText:o}}}]),u}(),Or=N()(He.prototype,"metrics",[kr,Sr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Br=N()(He.prototype,"enabled",[Tr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),He))||te)||te)||te)||te)||te)||te)||te),Fa=c(62402),_a=c(19689),Ra=c(63709),Pa=c(33428),Ar=c(15304),Nr=function(a){var r=a.data,n=(0,I.useRef)(null),e=(0,I.useRef)();return(0,I.useEffect)(function(){if(n.current){var t=new Ar.SmoothieChart({millisPerPixel:50,grid:{fillStyle:"#ffffff",strokeStyle:"rgba(119,119,119,0.22)",lineWidth:1},labels:{disabled:!0},tooltip:!1}),i=new Ar.TimeSeries;t.addTimeSeries(i,{lineWidth:1,strokeStyle:"rgba(24,144,255,1)",fillStyle:"rgba(24,144,255,0.2)",interpolation:"bezier"}),t.streamTo(n.current,2e3),e.current=i}},[]),(0,I.useEffect)(function(){e.current&&e.current.append(r.time,r.data)},[r]),(0,p.jsx)("canvas",{ref:n,width:"270",height:"60"})},La=function(a){var r=a.visible,n=a.close,e=(0,M.oC)(Ir),t=e.metrics,i=function(){var s=S()(f()().mark(function l(h){return f()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:h&&e.enable();case 1:case"end":return y.stop()}},l)}));return function(h){return s.apply(this,arguments)}}(),o=function(){e.disable(),n()};return(0,p.jsx)(Pa.Z,{placement:"right",onClose:function(){return o()},width:360,open:r,mask:!1,afterOpenChange:i,destroyOnClose:!0,title:A.U6.t("\u8D44\u6E90\u6D88\u8017"),children:(0,p.jsx)("div",{className:"secretnote-kernel-status",children:t.map(function(s){return(0,p.jsxs)("div",{className:"kernel-status-item",children:[(0,p.jsxs)("div",{className:"server-name",children:[s.server.name,":"]}),(0,p.jsxs)("div",{className:"metrics-item",children:[(0,p.jsxs)("span",{className:"label",children:[A.U6.t("\u540D\u79F0"),":"]}),(0,p.jsx)("span",{children:s.kernel.name})]}),(0,p.jsxs)("div",{className:"metrics-item",children:[(0,p.jsxs)("span",{className:"label",children:[A.U6.t("\u72B6\u6001"),":"]}),(0,p.jsx)(Ue.Z,{color:s.kernel.statusColor,text:s.kernel.statusText})]}),(0,p.jsxs)("div",{className:"metrics-item",children:[(0,p.jsx)("span",{className:"label",children:"PID:"}),(0,p.jsx)("span",{children:s.kernel.pid})]}),(0,p.jsxs)("div",{className:"metrics-item",children:[(0,p.jsx)("span",{className:"label",children:"CPU:"}),(0,p.jsx)("span",{children:s.kernel.cpuText})]}),(0,p.jsx)(Nr,{data:{time:Date.now(),data:s.kernel.cpu}}),(0,p.jsxs)("div",{className:"metrics-item",children:[(0,p.jsx)("span",{className:"label",children:"RAM:"}),(0,p.jsx)("span",{children:s.kernel.memoryText})]}),(0,p.jsx)(Nr,{data:{time:Date.now(),data:s.kernel.memory}})]},s.kernel.id)})})})},Mr={id:"secretnote-metrics-panel-modal",component:La},Er,jr,xr,Vr,Ie,gt={id:"metrics-panel-open"},Ka=function(){var a=(0,M.oC)($e.Z),r=function(){a.openModal(Mr)};return(0,p.jsx)(Ra.Z,{className:"chat-icon",onClick:r,size:16})},za=(Er=(0,B.ri)({contrib:[ye.p,Fa.H,_a.l]}),jr=function(a,r){return(0,B.f3)(v.w29)(a,void 0,0)},xr=Reflect.metadata("design:type",Function),Vr=Reflect.metadata("design:paramtypes",[typeof v.w29=="undefined"?Object:v.w29]),Er(Ie=jr(Ie=xr(Ie=Vr(Ie=function(){function u(a){W()(this,u),T()(this,"libroCommand",void 0),this.libroCommand=a}return X()(u,[{key:"registerCommands",value:function(r){this.libroCommand.registerLibroCommand(r,gt,{execute:function(){var n=S()(f()().mark(function t(i,o){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(!o||!(o instanceof v.yZV))){l.next=2;break}return l.abrupt("return");case 2:case"end":return l.stop()}},t)}));function e(t,i){return n.apply(this,arguments)}return e}(),isVisible:function(e,t,i){return i===v.xNW.HeaderRight},isEnabled:function(e,t){return!t||!(t instanceof v.yZV)?!1:!!t.model.kernelConnection}})}},{key:"registerToolbarItems",value:function(r){r.registerItem({id:gt.id,icon:Ka,command:gt.id,order:"a",tooltip:A.U6.t("\u67E5\u770B\u72B6\u6001")})}},{key:"registerModal",value:function(){return Mr}}]),u}())||Ie)||Ie)||Ie)||Ie),Da=we.R.create().register(za,Ir),Fr,_r,Rr,Pr,Ae,Za=(0,me.Q4)(),We=(Fr=(0,B.ri)(),_r=function(a,r){return(0,B.f3)(H.CP)(a,void 0,0)},Rr=Reflect.metadata("design:type",Function),Pr=Reflect.metadata("design:paramtypes",[typeof H.CP=="undefined"?Object:H.CP]),Fr(Ae=_r(Ae=Rr(Ae=Pr(Ae=function(){function u(a){W()(this,u),T()(this,"serverManager",void 0),this.serverManager=a}return X()(u,[{key:"nodes",get:function(){return this.serverManager.servers.map(function(r){return P()(P()({},r),{},{color:Za})})}},{key:"addNode",value:function(){var a=S()(f()().mark(function n(e){var t,i,o;return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.name,i=e.address,o=e.type,l.next=3,this.serverManager.addServer({name:t.trim(),address:i.trim(),type:o});case 3:case"end":return l.stop()}},n,this)}));function r(n){return a.apply(this,arguments)}return r}()},{key:"deleteNode",value:function(){var a=S()(f()().mark(function n(e){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.serverManager.deleteServer(e);case 2:case"end":return i.stop()}},n,this)}));function r(n){return a.apply(this,arguments)}return r}()},{key:"updateNodeName",value:function(){var a=S()(f()().mark(function n(e,t){return f()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.serverManager.updateServer(e,{name:t});case 2:case"end":return o.stop()}},n,this)}));function r(n,e){return a.apply(this,arguments)}return r}()},{key:"checkName",value:function(r){var n=this.nodes.every(function(e){return e.name!==r});return n}},{key:"checkAddress",value:function(r){var n=this,e=this.nodes.every(function(t){return n.normalizedAddress(t.address)!==n.normalizedAddress(r)});return e}},{key:"normalizedAddress",value:function(r){return r.replace("localhost","127.0.0.1")}}]),u}())||Ae)||Ae)||Ae)||Ae),Lr=c(99138),Ga=c(37806),Xe=c(34011),yt=c(35198),Kr=c(32368),$a=c(99997),zr,Dr,Zr,Gr,$r,ve,Ua=Ga.Z.Paragraph,Ur=function(a){var r=a.status;return r===H.U$.running?{status:"success",badgeStatus:"success",text:A.U6.t("\u5728\u7EBF")}:r===H.U$.error?{status:"error",badgeStatus:"error",text:A.U6.t("\u79BB\u7EBF")}:{status:"default",badgeStatus:"default",text:A.U6.t("\u79BB\u7EBF")}},Ha=function(a){var r=a.node,n=(0,M.oC)(he.yd),e=Ur(r),t=e.status,i=e.text,o=(0,I.useState)(r.name),s=ae()(o,2),l=s[0],h=s[1],d=function(){var g=S()(f()().mark(function w(b){return f()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,n.service.deleteNode(b);case 3:F.ZP.success(A.U6.t("\u5220\u9664\u6210\u529F")),m.next=9;break;case 6:m.prev=6,m.t0=m.catch(0),m.t0 instanceof Error&&F.ZP.error(m.t0.message);case 9:case"end":return m.stop()}},w,null,[[0,6]])}));return function(b){return g.apply(this,arguments)}}(),y=function(){var g=S()(f()().mark(function w(b,E){return f()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(b.name!==E){O.next=2;break}return O.abrupt("return");case 2:return O.prev=2,O.next=5,n.service.updateNodeName(b.id,E);case 5:h(E),O.next=11;break;case 8:O.prev=8,O.t0=O.catch(2),O.t0 instanceof Error&&F.ZP.error(O.t0.message);case 11:case"end":return O.stop()}},w,null,[[2,8]])}));return function(b,E){return g.apply(this,arguments)}}();return(0,p.jsxs)("div",{className:"secretnote-node-description",children:[(0,p.jsxs)(Xe.Z,{title:A.U6.t("\u8282\u70B9\u4FE1\u606F"),column:1,children:[(0,p.jsx)(Xe.Z.Item,{label:A.U6.t("\u540D\u79F0"),children:(0,p.jsx)(Ua,{editable:{onChange:function(w){return y(r,w)},tooltip:!1},children:l})}),(0,p.jsx)(Xe.Z.Item,{label:A.U6.t("\u5730\u5740"),children:r.address}),(0,p.jsx)(Xe.Z.Item,{label:A.U6.t("\u72B6\u6001"),children:(0,p.jsx)(Ue.Z,{status:t,text:i})})]}),(0,p.jsx)(yt.ZP,{type:"link",onClick:function(){d(r.id)},children:A.U6.t("\u5220\u9664")})]})},Wa=function(){var a=R.Z.useForm(),r=ae()(a,1),n=r[0],e=(0,I.useState)(!1),t=ae()(e,2),i=t[0],o=t[1],s=(0,I.useState)(!1),l=ae()(s,2),h=l[0],d=l[1],y=(0,M.oC)(he.yd),g=function(){n.validateFields().then(function(){var E=S()(f()().mark(function m(O){return f()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return d(!0),x.prev=1,x.next=4,y.service.addNode(O);case 4:o(!1),n.resetFields(),F.ZP.success(A.U6.t("\u8282\u70B9\u6DFB\u52A0\u6210\u529F")),x.next=12;break;case 9:x.prev=9,x.t0=x.catch(1),x.t0 instanceof Error&&F.ZP.error(x.t0.message);case 12:return x.prev=12,d(!1),x.finish(12);case 15:return x.abrupt("return");case 16:case"end":return x.stop()}},m,null,[[1,9,12,15]])}));return function(m){return E.apply(this,arguments)}}()).catch(function(){})},w=(0,p.jsx)("div",{className:"secretnote-add-node",children:(0,p.jsxs)(R.Z,{form:n,autoComplete:"off",requiredMark:!1,labelCol:{span:4},wrapperCol:{span:20},initialValues:{name:"",address:"",type:"common"},children:[(0,p.jsx)(R.Z.Item,{label:A.U6.t("\u540D\u79F0"),name:"name",rules:[{required:!0,message:A.U6.t("\u8BF7\u8F93\u5165\u540D\u79F0")},{max:16,message:A.U6.t("\u540D\u79F0\u8FC7\u957F")}],children:(0,p.jsx)(q.Z,{placeholder:"Alice"})}),(0,p.jsx)(R.Z.Item,{label:A.U6.t("\u5730\u5740"),name:"address",rules:[{required:!0,message:A.U6.t("\u8BF7\u8F93\u5165\u5730\u5740")},{max:100,message:A.U6.t("\u5730\u5740\u8FC7\u957F")}],children:(0,p.jsx)(q.Z,{placeholder:"127.0.0.1:8888"})}),(0,p.jsx)(R.Z.Item,{wrapperCol:{offset:4,span:20},style:{marginBottom:0},children:(0,p.jsx)($n.Z,{children:(0,p.jsx)(yt.ZP,{type:"primary",htmlType:"submit",onClick:function(){g()},loading:h,children:A.U6.t("\u6DFB\u52A0")})})})]})});return(0,p.jsxs)("div",{className:"secretnote-node",children:[(0,p.jsx)(Kr.C.Group,{children:y.service.nodes.map(function(b){return(0,p.jsx)(Ee.Z,{content:(0,p.jsx)(Ha,{node:b}),title:"",overlayClassName:"secretnote-node-popover",overlayStyle:{width:280},trigger:"click",placement:"bottomLeft",arrow:!1,children:(0,p.jsx)(Ue.Z,{status:Ur(b).badgeStatus,dot:!0,offset:[-28,4],children:(0,p.jsx)(Kr.C,{shape:"square",style:{backgroundColor:b.color,cursor:"pointer"},children:(0,p.jsx)("span",{style:{color:(0,me.U_)(b.color)},children:b.name.slice(0,1).toUpperCase()})})})},b.id)})}),(0,p.jsx)(Ee.Z,{content:w,title:"",overlayClassName:"secretnote-node-popover",overlayStyle:{width:446},trigger:"click",placement:"bottomLeft",open:i,onOpenChange:function(E){n.resetFields(),o(E)},arrow:!1,children:(0,p.jsx)(yt.ZP,{icon:(0,p.jsx)($a.Z,{size:16}),className:"btn",onClick:function(){return o(!0)}})})]})},Hr=(zr=(0,B.ri)(),Dr=(0,ge.ei)("secretnote-node-view"),Zr=function(a,r){return(0,B.f3)(We)(a,void 0,0)},Gr=Reflect.metadata("design:type",Function),$r=Reflect.metadata("design:paramtypes",[typeof We=="undefined"?Object:We]),zr(ve=Dr(ve=Zr(ve=Gr(ve=$r(ve=function(u){ue()(r,u);var a=ce()(r);function r(n){var e;return W()(this,r),e=a.call(this),T()(C()(e),"view",Wa),T()(C()(e),"service",void 0),e.service=n,e}return X()(r)}(Lr.P))||ve)||ve)||ve)||ve)||ve),Xa=we.R.create().register(Hr,We,(0,ge.bQ)({slot:mr.Mx.right,view:Hr,autoCreate:!0})),Ja=c(20252),Ya=c(97341),Qa=c(352),Wr,Xr,Je,qa=function(){return(0,p.jsx)("div",{className:"secretnote-welcome-page",children:"Welcome to SecretNote."})},Jr=(Wr=(0,B.ri)(),Xr=(0,ge.ei)("secretnote-welcome-view"),Wr(Je=Xr(Je=function(u){ue()(r,u);var a=ce()(r);function r(){var n;W()(this,r);for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n=a.call.apply(a,[this].concat(t)),T()(C()(n),"view",qa),n}return X()(r)}(Lr.P))||Je)||Je),ei=we.R.create().register(Jr,(0,ge.bQ)({slot:Ke.ux.welcome,view:Jr,autoCreate:!0})),ti=function(){return(0,p.jsx)(De.rF.Application,{asChild:!0,modules:[Ye.n6L,mr.xu,Ya.O,Ja.F,Ea,Ke.qi,Xa,Qa.V,ja.Q,Da,xa.p,ei,va]},"libro-app")},ni=ti}}]);
