rm(p0)
grid.arrange(arrangeGrob(arrangeGrob(p1_alaska+theme(legend.position = "none"),left = "ERA5"),
arrangeGrob(p2_alaska+theme(legend.position = "none"),left = "BART-BMM"),
arrangeGrob(d2_alaska+theme(legend.position = "none"),left = "NNFWLS"),
#arrangeGrob(p4_alaska+theme(legend.position = "none"),top = "FWLS"),
top = "Alaska & W. Canada",nrow = 3),
arrangeGrob(p1_rocky+theme(legend.position = "none"),
p2_rocky+theme(legend.position = "none"),
d2_rocky+theme(legend.position = "none"),
#p4_rocky+theme(legend.position = "none"),
top = "Rocky Mts.",nrow = 1,pleg2, widths = c(1,1,1,1,0.3)),
arrangeGrob(p1_sib+theme(legend.position = "none"),
p2_sib+theme(legend.position = "none"),
d2_sib+theme(legend.position = "none"),
#p4_sib+theme(legend.position = "none"),
top = "Suntar-Khayata Mts.",nrow = 1,pleg3, widths = c(1,1,1,1,0.3)),
arrangeGrob(p1_tib+theme(legend.position = "none"),
p2_tib+theme(legend.position = "none"),
d2_tib+theme(legend.position = "none"),
#p4_tib+theme(legend.position = "none"),
top = "Tibetan Plateau",nrow = 1,pleg4, widths = c(1,1,1,1,0.3)),
ncol = 4, widths = c(1,1,1,1))
grid.arrange(arrangeGrob(arrangeGrob(p1_alaska+theme(legend.position = "none"),left = "ERA5"),
arrangeGrob(p2_alaska+theme(legend.position = "none"),left = "BART-BMM"),
arrangeGrob(d2_alaska+theme(legend.position = "none"),left = "NNFWLS"),
#arrangeGrob(p4_alaska+theme(legend.position = "none"),top = "FWLS"),
top = "Alaska & W. Canada",nrow = 3),
arrangeGrob(p1_rocky+theme(legend.position = "none"),
p2_rocky+theme(legend.position = "none"),
d2_rocky+theme(legend.position = "none"),
#p4_rocky+theme(legend.position = "none"),
top = "Rocky Mts.",nrow = 3),
arrangeGrob(p1_sib+theme(legend.position = "none"),
p2_sib+theme(legend.position = "none"),
d2_sib+theme(legend.position = "none"),
#p4_sib+theme(legend.position = "none"),
top = "Suntar-Khayata Mts.",nrow = 3),
arrangeGrob(p1_tib+theme(legend.position = "none"),
p2_tib+theme(legend.position = "none"),
d2_tib+theme(legend.position = "none"),
#p4_tib+theme(legend.position = "none"),
top = "Tibetan Plateau",nrow = 3),
ncol = 4, widths = c(1,1,1,1))
grid.arrange(arrangeGrob(pleg1,arrangeGrob(p1_alaska+theme(legend.position = "none"),top = "ERA5"),
arrangeGrob(p2_alaska+theme(legend.position = "none"),top = "BART-BMM"),
arrangeGrob(d2_alaska+theme(legend.position = "none"),top = "NNFWLS"),
#arrangeGrob(p4_alaska+theme(legend.position = "none"),top = "FWLS"),
d_leg,
left = "Alaska & W. Canada",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg2,p1_rocky+theme(legend.position = "none"),
p2_rocky+theme(legend.position = "none"),
d2_rocky+theme(legend.position = "none"),
#p4_rocky+theme(legend.position = "none"),
d_leg,
left = "Rocky Mts.",nrow = 1,widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg3,p1_sib+theme(legend.position = "none"),
p2_sib+theme(legend.position = "none"),
d2_sib+theme(legend.position = "none"),
#p4_sib+theme(legend.position = "none"),
d_leg,
left = "Suntar-Khayata Mts.",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg4,p1_tib+theme(legend.position = "none"),
p2_tib+theme(legend.position = "none"),
d2_tib+theme(legend.position = "none"),
#p4_tib+theme(legend.position = "none"),
d_leg,
left = "Tibetan Plateau",nrow = 1, widths = c(0.3,1,1,1,0.3)),
ncol = 4, widths = c(1,1,1,1))
grid.arrange(arrangeGrob(pleg1,arrangeGrob(p1_alaska+theme(legend.position = "none"),top = "ERA5"),
arrangeGrob(p2_alaska+theme(legend.position = "none"),top = "BART-BMM"),
arrangeGrob(d2_alaska+theme(legend.position = "none"),top = "NNFWLS"),
#arrangeGrob(p4_alaska+theme(legend.position = "none"),top = "FWLS"),
d_leg,
left = "Alaska & W. Canada",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg2,p1_rocky+theme(legend.position = "none"),
p2_rocky+theme(legend.position = "none"),
d2_rocky+theme(legend.position = "none"),
#p4_rocky+theme(legend.position = "none"),
d_leg,
left = "Rocky Mts.",nrow = 1,widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg3,p1_sib+theme(legend.position = "none"),
p2_sib+theme(legend.position = "none"),
d2_sib+theme(legend.position = "none"),
#p4_sib+theme(legend.position = "none"),
d_leg,
left = "Suntar-Khayata Mts.",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg4,p1_tib+theme(legend.position = "none"),
p2_tib+theme(legend.position = "none"),
d2_tib+theme(legend.position = "none"),
#p4_tib+theme(legend.position = "none"),
d_leg,
left = "Tibetan Plateau",nrow = 1, widths = c(0.3,1,1,1,0.3)),
nrow = 4)
h = h1
plabs = c("alaska","rocky","sib","tib")
xbnds_list = list(c(-180,-100,48,75),
c(-125,-102,30,50),
c(115,175,45,75),
#c(-85,-55,-65,10),
c(65,105,25,45))
scale_list = list(c(-25,15),c(-5,35),c(-20,15),c(-25,35))
title_list = c("ERA5","BART-BMM","NNFWLS","FWLS")
for(i in 1:4){
for(j in 1:2){
if(j == 1){pmean = ms$y_test[h]}
if(j == 2){pmean = fit1$proj_mean[h]}
if(j == 3){pmean = fit3$pred[h]}
if(j == 4){pmean = fit2$pred_mean[h]}
p0 = plot_mean2d_map_viridis(xs_test[h,1:2],pmean,xcols = c(1,2),
viridis_opt = "viridis",
scale_limit = scale_list[[i]], title = title_list[j],
maps_list = list(data.frame(world),data.frame(states)),
maps_cols = c("grey30","grey30"),
lat_bnds = xbnds_list[[i]][3:4],
lon_bnds = xbnds_list[[i]][1:2]
)
p0 = p0 +  theme(axis.title = element_blank(), plot.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank())
p_leg = g_legend(p0+theme(legend.position = "right",
legend.title = element_blank()))
if(j == 2){
d0b = plot_mean2d_map_gradient(xs_test[hlist[[1]],],as.matrix(fit1$delta_mean[hlist[[1]]]),
xcols = c(1,2),
title=mlist[i],
scale_colors = dpal, scale_vals = dsv,
maps_list = list(data.frame(world),data.frame(states)),
maps_cols = c("grey40","grey40"),
lat_bnds = xbnds_list[[i]][3:4],
lon_bnds = xbnds_list[[i]][1:2])
d0b = d0b + labs(fill = wk_lab, x = "Longitude", y = "Latitude") +
theme(axis.title = element_text(size=18))
d0b = d0b + theme(axis.text=element_blank(),
axis.title=element_blank(),
plot.title = element_text(size = 15),legend.title = element_text(size = 16))
d_lge = g_legend(d0b + theme(legend.position = "right"))
}
assign(paste0("d",j,"_",plabs[i]), d0b)
assign(paste0("p",j,"_",plabs[i]), p0)
assign(paste0("pleg",i), p_leg)
assign(paste0("dleg",i), d_leg)
}
}
rm(p0)
grid.arrange(arrangeGrob(pleg1,arrangeGrob(p1_alaska+theme(legend.position = "none"),top = "ERA5"),
arrangeGrob(p2_alaska+theme(legend.position = "none"),top = "BART-BMM"),
arrangeGrob(d2_alaska+theme(legend.position = "none"),top = "NNFWLS"),
#arrangeGrob(p4_alaska+theme(legend.position = "none"),top = "FWLS"),
dleg1,
left = "Alaska & W. Canada",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg2,p1_rocky+theme(legend.position = "none"),
p2_rocky+theme(legend.position = "none"),
d2_rocky+theme(legend.position = "none"),
#p4_rocky+theme(legend.position = "none"),
dleg2,
left = "Rocky Mts.",nrow = 1,widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg3,p1_sib+theme(legend.position = "none"),
p2_sib+theme(legend.position = "none"),
d2_sib+theme(legend.position = "none"),
#p4_sib+theme(legend.position = "none"),
dle3,
left = "Suntar-Khayata Mts.",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg4,p1_tib+theme(legend.position = "none"),
p2_tib+theme(legend.position = "none"),
d2_tib+theme(legend.position = "none"),
#p4_tib+theme(legend.position = "none"),
dleg4,
left = "Tibetan Plateau",nrow = 1, widths = c(0.3,1,1,1,0.3)),
nrow = 4)
grid.arrange(arrangeGrob(pleg1,arrangeGrob(p1_alaska+theme(legend.position = "none"),top = "ERA5"),
arrangeGrob(p2_alaska+theme(legend.position = "none"),top = "BART-BMM"),
arrangeGrob(d2_alaska+theme(legend.position = "none"),top = "NNFWLS"),
#arrangeGrob(p4_alaska+theme(legend.position = "none"),top = "FWLS"),
dleg1,
left = "Alaska & W. Canada",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg2,p1_rocky+theme(legend.position = "none"),
p2_rocky+theme(legend.position = "none"),
d2_rocky+theme(legend.position = "none"),
#p4_rocky+theme(legend.position = "none"),
dleg2,
left = "Rocky Mts.",nrow = 1,widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg3,p1_sib+theme(legend.position = "none"),
p2_sib+theme(legend.position = "none"),
d2_sib+theme(legend.position = "none"),
#p4_sib+theme(legend.position = "none"),
dleg3,
left = "Suntar-Khayata Mts.",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg4,p1_tib+theme(legend.position = "none"),
p2_tib+theme(legend.position = "none"),
d2_tib+theme(legend.position = "none"),
#p4_tib+theme(legend.position = "none"),
dleg4,
left = "Tibetan Plateau",nrow = 1, widths = c(0.3,1,1,1,0.3)),
nrow = 4)
h = h1
plabs = c("alaska","rocky","sib","tib")
xbnds_list = list(c(-180,-100,48,75),
c(-125,-102,30,50),
c(115,175,45,75),
#c(-85,-55,-65,10),
c(65,105,25,45))
scale_list = list(c(-25,15),c(-5,35),c(-20,15),c(-25,35))
title_list = c("ERA5","BART-BMM","NNFWLS","FWLS")
for(i in 1:4){
for(j in 1:2){
if(j == 1){pmean = ms$y_test[h]}
if(j == 2){pmean = fit1$proj_mean[h]}
if(j == 3){pmean = fit3$pred[h]}
if(j == 4){pmean = fit2$pred_mean[h]}
p0 = plot_mean2d_map_viridis(xs_test[h,1:2],pmean,xcols = c(1,2),
viridis_opt = "viridis",
scale_limit = scale_list[[i]], title = title_list[j],
maps_list = list(data.frame(world),data.frame(states)),
maps_cols = c("grey30","grey30"),
lat_bnds = xbnds_list[[i]][3:4],
lon_bnds = xbnds_list[[i]][1:2]
)
p0 = p0 +  theme(axis.title = element_blank(), plot.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank())
p_leg = g_legend(p0+theme(legend.position = "right",
legend.title = element_blank()))
if(j == 2){
d0b = plot_mean2d_map_gradient(xs_test[hlist[[1]],],as.matrix(fit1$delta_mean[hlist[[1]]]),
xcols = c(1,2),
title=mlist[i],
scale_colors = dpal, scale_vals = dsv,
maps_list = list(data.frame(world),data.frame(states)),
maps_cols = c("grey40","grey40"),
lat_bnds = xbnds_list[[i]][3:4],
lon_bnds = xbnds_list[[i]][1:2])
d0b = d0b + labs(fill = wk_lab, x = "Longitude", y = "Latitude") +
theme(axis.title = element_text(size=18))
d0b = d0b + theme(axis.text=element_blank(),
axis.title=element_blank(),
plot.title = element_text(size = 15),legend.title = element_text(size = 16))
d_leg = g_legend(d0b + theme(legend.position = "right"))
}
assign(paste0("d",j,"_",plabs[i]), d0b)
assign(paste0("p",j,"_",plabs[i]), p0)
assign(paste0("pleg",i), p_leg)
assign(paste0("dleg",i), d_leg)
}
}
rm(p0)
grid.arrange(arrangeGrob(pleg1,arrangeGrob(p1_alaska+theme(legend.position = "none"),top = "ERA5"),
arrangeGrob(p2_alaska+theme(legend.position = "none"),top = "BART-BMM"),
arrangeGrob(d2_alaska+theme(legend.position = "none"),top = "NNFWLS"),
#arrangeGrob(p4_alaska+theme(legend.position = "none"),top = "FWLS"),
dleg1,
left = "Alaska & W. Canada",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg2,p1_rocky+theme(legend.position = "none"),
p2_rocky+theme(legend.position = "none"),
d2_rocky+theme(legend.position = "none"),
#p4_rocky+theme(legend.position = "none"),
dleg2,
left = "Rocky Mts.",nrow = 1,widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg3,p1_sib+theme(legend.position = "none"),
p2_sib+theme(legend.position = "none"),
d2_sib+theme(legend.position = "none"),
#p4_sib+theme(legend.position = "none"),
dleg3,
left = "Suntar-Khayata Mts.",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg4,p1_tib+theme(legend.position = "none"),
p2_tib+theme(legend.position = "none"),
d2_tib+theme(legend.position = "none"),
#p4_tib+theme(legend.position = "none"),
dleg4,
left = "Tibetan Plateau",nrow = 1, widths = c(0.3,1,1,1,0.3)),
nrow = 4)
h = h1
plabs = c("alaska","rocky","sib","tib")
xbnds_list = list(c(-180,-100,48,75),
c(-125,-102,30,50),
c(115,175,45,75),
#c(-85,-55,-65,10),
c(65,105,25,45))
scale_list = list(c(-25,15),c(-5,35),c(-20,15),c(-25,35))
title_list = c("ERA5","BART-BMM","NNFWLS","FWLS")
for(i in 1:4){
for(j in 1:2){
if(j == 1){pmean = ms$y_test[h]}
if(j == 2){pmean = fit1$proj_mean[h]}
if(j == 3){pmean = fit3$pred[h]}
if(j == 4){pmean = fit2$pred_mean[h]}
p0 = plot_mean2d_map_viridis(xs_test[h,1:2],pmean,xcols = c(1,2),
viridis_opt = "viridis",
scale_limit = scale_list[[i]], title = title_list[j],
maps_list = list(data.frame(world),data.frame(states)),
maps_cols = c("grey30","grey30"),
lat_bnds = xbnds_list[[i]][3:4],
lon_bnds = xbnds_list[[i]][1:2]
)
p0 = p0 +  theme(axis.title = element_blank(), plot.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank())
p_leg = g_legend(p0+theme(legend.position = "right",
legend.title = element_blank()))
if(j == 2){
d0b = plot_mean2d_map_gradient(xs_test[hlist[[1]],],as.matrix(fit1$delta_mean[hlist[[1]]]),
xcols = c(1,2),
title="",
scale_colors = dpal, scale_vals = dsv,
maps_list = list(data.frame(world),data.frame(states)),
maps_cols = c("grey40","grey40"),
lat_bnds = xbnds_list[[i]][3:4],
lon_bnds = xbnds_list[[i]][1:2])
d0b = d0b + labs(fill = wk_lab, x = "Longitude", y = "Latitude") +
theme(axis.title = element_text(size=18))
d0b = d0b + theme(axis.text=element_blank(),
axis.title=element_blank(),
plot.title = element_blank(),legend.title = element_blank())
d_leg = g_legend(d0b + theme(legend.position = "right"))
}
assign(paste0("d",j,"_",plabs[i]), d0b)
assign(paste0("p",j,"_",plabs[i]), p0)
assign(paste0("pleg",i), p_leg)
assign(paste0("dleg",i), d_leg)
}
}
rm(p0)
grid.arrange(arrangeGrob(pleg1,arrangeGrob(p1_alaska+theme(legend.position = "none"),top = "ERA5"),
arrangeGrob(p2_alaska+theme(legend.position = "none"),top = "BART-BMM"),
arrangeGrob(d2_alaska+theme(legend.position = "none"),top = "NNFWLS"),
#arrangeGrob(p4_alaska+theme(legend.position = "none"),top = "FWLS"),
dleg1,
left = "Alaska & W. Canada",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg2,p1_rocky+theme(legend.position = "none"),
p2_rocky+theme(legend.position = "none"),
d2_rocky+theme(legend.position = "none"),
#p4_rocky+theme(legend.position = "none"),
dleg2,
left = "Rocky Mts.",nrow = 1,widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg3,p1_sib+theme(legend.position = "none"),
p2_sib+theme(legend.position = "none"),
d2_sib+theme(legend.position = "none"),
#p4_sib+theme(legend.position = "none"),
dleg3,
left = "Suntar-Khayata Mts.",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg4,p1_tib+theme(legend.position = "none"),
p2_tib+theme(legend.position = "none"),
d2_tib+theme(legend.position = "none"),
#p4_tib+theme(legend.position = "none"),
dleg4,
left = "Tibetan Plateau",nrow = 1, widths = c(0.3,1,1,1,0.3)),
nrow = 4)
h = h1
plabs = c("alaska","rocky","sib","tib")
xbnds_list = list(c(-180,-100,48,75),
c(-125,-102,30,50),
c(115,175,45,75),
#c(-85,-55,-65,10),
c(65,105,25,45))
scale_list = list(c(-25,15),c(-5,35),c(-20,15),c(-25,35))
title_list = c("ERA5","BART-BMM Pojections","NNFWLS","FWLS")
for(i in 1:4){
for(j in 1:2){
if(j == 1){pmean = ms$y_test[h]}
if(j == 2){pmean = fit1$proj_mean[h]}
if(j == 3){pmean = fit3$pred[h]}
if(j == 4){pmean = fit2$pred_mean[h]}
p0 = plot_mean2d_map_viridis(xs_test[h,1:2],pmean,xcols = c(1,2),
viridis_opt = "viridis",
scale_limit = scale_list[[i]], title = title_list[j],
maps_list = list(data.frame(world),data.frame(states)),
maps_cols = c("grey30","grey30"),
lat_bnds = xbnds_list[[i]][3:4],
lon_bnds = xbnds_list[[i]][1:2]
)
p0 = p0 +  theme(axis.title = element_blank(), plot.title = element_blank(),
axis.text = element_blank(), axis.ticks = element_blank())
p_leg = g_legend(p0+theme(legend.position = "right",
legend.title = element_blank()))
if(j == 2){
d0b = plot_mean2d_map_gradient(xs_test[hlist[[1]],],as.matrix(fit1$delta_mean[hlist[[1]]]),
xcols = c(1,2),
title="",
scale_colors = dpal, scale_vals = dsv,
maps_list = list(data.frame(world),data.frame(states)),
maps_cols = c("grey40","grey40"),
lat_bnds = xbnds_list[[i]][3:4],
lon_bnds = xbnds_list[[i]][1:2])
d0b = d0b + labs(fill = wk_lab, x = "Longitude", y = "Latitude") +
theme(axis.title = element_text(size=18))
d0b = d0b + theme(axis.text=element_blank(),
axis.title=element_blank(),
plot.title = element_blank(),legend.title = element_blank())
d_leg = g_legend(d0b + theme(legend.position = "right"))
}
assign(paste0("d",j,"_",plabs[i]), d0b)
assign(paste0("p",j,"_",plabs[i]), p0)
assign(paste0("pleg",i), p_leg)
assign(paste0("dleg",i), d_leg)
}
}
rm(p0)
grid.arrange(arrangeGrob(pleg1,arrangeGrob(p1_alaska+theme(legend.position = "none"),top = "ERA5"),
arrangeGrob(p2_alaska+theme(legend.position = "none"),
top = TeX("$\\sum_{l = 1}^K u_l(x) \\hat{f}_l(x)$")),
arrangeGrob(d2_alaska+theme(legend.position = "none"),top =TeX("$\\delta(x)$")),
#arrangeGrob(p4_alaska+theme(legend.position = "none"),top = "FWLS"),
dleg1,
left = "Alaska & W. Canada",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg2,p1_rocky+theme(legend.position = "none"),
p2_rocky+theme(legend.position = "none"),
d2_rocky+theme(legend.position = "none"),
#p4_rocky+theme(legend.position = "none"),
dleg2,
left = "Rocky Mts.",nrow = 1,widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg3,p1_sib+theme(legend.position = "none"),
p2_sib+theme(legend.position = "none"),
d2_sib+theme(legend.position = "none"),
#p4_sib+theme(legend.position = "none"),
dleg3,
left = "Suntar-Khayata Mts.",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg4,p1_tib+theme(legend.position = "none"),
p2_tib+theme(legend.position = "none"),
d2_tib+theme(legend.position = "none"),
#p4_tib+theme(legend.position = "none"),
dleg4,
left = "Tibetan Plateau",nrow = 1, widths = c(0.3,1,1,1,0.3)),
nrow = 4)
TeX("$\\delta(x)$")
grid.arrange(arrangeGrob(pleg1,arrangeGrob(p1_alaska+theme(legend.position = "none"),top = "ERA5"),
arrangeGrob(p2_alaska+theme(legend.position = "none"),
top = TeX("$\\sum_{l = 1}^K u_l(x) \\hat{f}_l(x)$")),
arrangeGrob(d2_alaska+theme(legend.position = "none"),top = grid.text(TeX("$\\delta(x)$"))),
#arrangeGrob(p4_alaska+theme(legend.position = "none"),top = "FWLS"),
dleg1,
left = "Alaska & W. Canada",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg2,p1_rocky+theme(legend.position = "none"),
p2_rocky+theme(legend.position = "none"),
d2_rocky+theme(legend.position = "none"),
#p4_rocky+theme(legend.position = "none"),
dleg2,
left = "Rocky Mts.",nrow = 1,widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg3,p1_sib+theme(legend.position = "none"),
p2_sib+theme(legend.position = "none"),
d2_sib+theme(legend.position = "none"),
#p4_sib+theme(legend.position = "none"),
dleg3,
left = "Suntar-Khayata Mts.",nrow = 1, widths = c(0.3,1,1,1,0.3)),
arrangeGrob(pleg4,p1_tib+theme(legend.position = "none"),
p2_tib+theme(legend.position = "none"),
d2_tib+theme(legend.position = "none"),
#p4_tib+theme(legend.position = "none"),
dleg4,
left = "Tibetan Plateau",nrow = 1, widths = c(0.3,1,1,1,0.3)),
nrow = 4)
dsv
res_table = matrix(0,ncol = 3, nrow = 11)
res_table = matrix(0,ncol = 3, nrow = 11)
res_table[1,1] = sqrt(mean((fit1$pred_mean[h1] -  ms$y_test[h1])^2))
res_table[1,2] = sqrt(mean((fit1$pred_mean[h2] -  ms$y_test[h2])^2))
res_table[1,3] = sqrt(mean((fit1$pred_mean[h3] -  ms$y_test[h3])^2))
res_table[2,1] = sqrt(mean((fit2$pred_mean[h1] -  ms$y_test[h1])^2))
res_table[2,2] = sqrt(mean((fit2$pred_mean[h2] -  ms$y_test[h2])^2))
res_table[2,3] = sqrt(mean((fit2$pred_mean[h3] -  ms$y_test[h3])^2))
res_table[3,1] = sqrt(mean((fit3$pred[h1] -  ms$y_test[h1])^2))
res_table[3,2] = sqrt(mean((fit3$pred[h2] -  ms$y_test[h2])^2))
res_table[3,3] = sqrt(mean((fit3$pred[h3] -  ms$y_test[h3])^2))
for(i in 4:11){
j = i - 3
res_table[j,1] = sqrt(mean((ms$f_test[h1,j] -  ms$y_test[h1])^2))
res_table[j,2] = sqrt(mean((ms$f_test[h2,j] -  ms$y_test[h2])^2))
res_table[j,3] = sqrt(mean((ms$f_test[h3,j] -  ms$y_test[h3])^2))
}
res_table
res_table = matrix(0,ncol = 3, nrow = 11)
res_table[1,1] = sqrt(mean((fit1$pred_mean[h1] -  ms$y_test[h1])^2))
res_table[1,2] = sqrt(mean((fit1$pred_mean[h2] -  ms$y_test[h2])^2))
res_table[1,3] = sqrt(mean((fit1$pred_mean[h3] -  ms$y_test[h3])^2))
res_table[2,1] = sqrt(mean((fit2$pred_mean[h1] -  ms$y_test[h1])^2))
res_table[2,2] = sqrt(mean((fit2$pred_mean[h2] -  ms$y_test[h2])^2))
res_table[2,3] = sqrt(mean((fit2$pred_mean[h3] -  ms$y_test[h3])^2))
res_table[3,1] = sqrt(mean((fit3$pred[h1] -  ms$y_test[h1])^2))
res_table[3,2] = sqrt(mean((fit3$pred[h2] -  ms$y_test[h2])^2))
res_table[3,3] = sqrt(mean((fit3$pred[h3] -  ms$y_test[h3])^2))
for(i in 4:11){
j = i - 3
res_table[i,1] = sqrt(mean((ms$f_test[h1,j] -  ms$y_test[h1])^2))
res_table[i,2] = sqrt(mean((ms$f_test[h2,j] -  ms$y_test[h2])^2))
res_table[i,3] = sqrt(mean((ms$f_test[h3,j] -  ms$y_test[h3])^2))
}
res_table
res_table = matrix(0,ncol = 3, nrow = 11)
res_table[1,1] = sqrt(mean((fit1$pred_mean[h1] -  ms$y_test[h1])^2))
res_table[1,2] = sqrt(mean((fit1$pred_mean[h2] -  ms$y_test[h2])^2))
res_table[1,3] = sqrt(mean((fit1$pred_mean[h3] -  ms$y_test[h3])^2))
res_table[2,1] = sqrt(mean((fit3$pred[h1] -  ms$y_test[h1])^2))
res_table[2,2] = sqrt(mean((fit3$pred[h2] -  ms$y_test[h2])^2))
res_table[2,3] = sqrt(mean((fit3$pred[h3] -  ms$y_test[h3])^2))
res_table[3,1] = sqrt(mean((fit2$pred_mean[h1] -  ms$y_test[h1])^2))
res_table[3,2] = sqrt(mean((fit2$pred_mean[h2] -  ms$y_test[h2])^2))
res_table[3,3] = sqrt(mean((fit2$pred_mean[h3] -  ms$y_test[h3])^2))
for(i in 4:11){
j = i - 3
res_table[i,1] = sqrt(mean((ms$f_test[h1,j] -  ms$y_test[h1])^2))
res_table[i,2] = sqrt(mean((ms$f_test[h2,j] -  ms$y_test[h2])^2))
res_table[i,3] = sqrt(mean((ms$f_test[h3,j] -  ms$y_test[h3])^2))
}
library(kableExtra)
install.packages("kable.Extra")
library(kableExtra)
library(kable.Extra)
install.packages("kableExtra")
library(kable.Extra)
library(kableExtra)
res_table %>% kable()
res_table %>% kable() %>% kable_styling(full_width = FALSE)
rownames(res_table)
sn
rownames(res_table) = c("BART-BMM","NNFWLS","FWLS",sn)
rownames(res_table) = c("BART-BMM","NNFWLS","FWLS",sn)
colnames(res_table) = c("April","August","December")
