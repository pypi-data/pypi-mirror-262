{#- Copyright 2024 RADar-AZDelta -#}
{#- SPDX-License-Identifier: gpl3+ -#}
CREATE OR REPLACE TABLE `{{dataset_work}}.{{omop_table}}_upload` AS
SELECT DISTINCT *
FROM (
    {%- for upload_table in upload_tables -%}
        {%- if not loop.first %}
    UNION ALL
        {%- endif %}
    SELECT 
    {%- for column in columns -%}
        {%- if not loop.first -%}
            {{ ',' }}
        {%- endif %}
        {{ column }} 
    {%- endfor %}
    FROM `{{dataset_work}}.{{omop_table}}__upload__{{upload_table}}`
    {%- endfor %}
) t